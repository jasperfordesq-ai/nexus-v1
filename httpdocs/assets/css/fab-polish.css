/**
 * Floating Action Button Polish
 * Bounce-in animation, expanded state, speed dial
 * Version: 1.1 - 2026-01-21 - Migrated to design tokens
 *
 * Features:
 * - Material Design 3 style FAB
 * - Bounce-in entrance animation
 * - Expand/collapse with speed dial
 * - Multiple sizes and colors
 * - Dark mode support
 * - Design token integration (~95% coverage)
 */

/* ==========================================================================
   Animations
   ========================================================================== */

@keyframes fab-bounce-in {
    0% {
        opacity: 0;
        transform: scale(0) rotate(-180deg);
    }
    50% {
        transform: scale(1.1) rotate(0deg);
    }
    70% {
        transform: scale(0.95);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes fab-bounce-out {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    100% {
        opacity: 0;
        transform: scale(0) rotate(180deg);
    }
}

@keyframes fab-pulse {
    0% {
        box-shadow: 0 var(--space-3) var(--space-3) rgba(99, 102, 241, 0.4);
    }
    50% {
        box-shadow:
            0 var(--space-3) var(--space-3) rgba(99, 102, 241, 0.4),
            0 0 0 var(--space-2) rgba(99, 102, 241, 0.1);
    }
    100% {
        box-shadow: 0 var(--space-3) var(--space-3) rgba(99, 102, 241, 0.4);
    }
}

@keyframes fab-rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(45deg); }
}

@keyframes fab-action-in {
    0% {
        opacity: 0;
        transform: scale(0) translateY(var(--space-5));
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* ==========================================================================
   Base FAB Styles
   ========================================================================== */

.fab,
.floating-action-button {
    position: fixed;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    font-size: var(--font-size-2xl);
    color: white;
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(99, 102, 241, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
    transition:
        transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1),
        box-shadow 0.2s ease,
        background 0.2s ease;
    z-index: var(--z-toast);
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}

/* Entrance animation */
.fab.fab-animate-in,
.floating-action-button.fab-animate-in {
    animation: fab-bounce-in 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* Exit animation */
.fab.fab-animate-out,
.floating-action-button.fab-animate-out {
    animation: fab-bounce-out 0.3s ease-out forwards;
}

/* Hover state */
.fab:hover,
.floating-action-button:hover {
    transform: scale(1.08);
    box-shadow:
        0 var(--space-5) var(--space-5) rgba(99, 102, 241, 0.5),
        0 var(--space-3) var(--space-2) rgba(0, 0, 0, 0.15);
}

/* Active/pressed state */
.fab:active,
.floating-action-button:active {
    transform: scale(0.95);
    box-shadow:
        0 var(--space-1) var(--space-2) rgba(99, 102, 241, 0.3),
        0 1px var(--space-1) rgba(0, 0, 0, 0.1);
}

/* Focus state */
.fab:focus-visible,
.floating-action-button:focus-visible {
    outline: 2px solid white;
    outline-offset: var(--space-1);
}

/* ==========================================================================
   FAB Sizes
   ========================================================================== */

/* Small - 40px */
.fab--sm,
.fab-small {
    width: var(--space-10);
    height: var(--space-10);
    font-size: var(--font-size-lg);
    border-radius: var(--radius-md);
}

/* Medium (default) - 56px */
.fab,
.fab--md,
.floating-action-button {
    width: 56px;
    height: 56px;
}

/* Large - 72px */
.fab--lg,
.fab-large {
    width: 72px;
    height: 72px;
    font-size: 28px;
    border-radius: var(--radius-xl);
}

/* Extended FAB with label */
.fab--extended,
.fab-extended {
    width: auto;
    padding: 0 var(--space-5);
    gap: var(--space-2);
    border-radius: 28px;
}

.fab--extended .fab-label,
.fab-extended .fab-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    white-space: nowrap;
}

/* ==========================================================================
   FAB Positions
   ========================================================================== */

/* Bottom right (default) */
.fab,
.fab--bottom-right {
    bottom: var(--space-6);
    right: var(--space-6);
}

/* Bottom left */
.fab--bottom-left {
    bottom: var(--space-6);
    left: var(--space-6);
    right: auto;
}

/* Bottom center */
.fab--bottom-center {
    bottom: var(--space-6);
    left: 50%;
    right: auto;
    transform: translateX(-50%);
}

.fab--bottom-center:hover {
    transform: translateX(-50%) scale(1.08);
}

/* Top right */
.fab--top-right {
    top: var(--space-20);
    right: var(--space-6);
    bottom: auto;
}

/* ==========================================================================
   FAB Colors
   ========================================================================== */

/* Primary (default) - Indigo/Purple gradient */
.fab--primary {
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
}

/* Secondary - Gray */
.fab--secondary {
    background: linear-gradient(135deg, var(--color-slate-500), var(--color-slate-600));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(71, 85, 105, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
}

/* Success - Green */
.fab--success {
    background: linear-gradient(135deg, var(--color-green-500), var(--color-green-600));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(34, 197, 94, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
}

/* Danger - Red */
.fab--danger {
    background: linear-gradient(135deg, var(--color-red-500), var(--color-red-600));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(239, 68, 68, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
}

/* Warning - Amber */
.fab--warning {
    background: linear-gradient(135deg, var(--color-amber-500), var(--color-amber-600));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(245, 158, 11, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
}

/* Info - Blue */
.fab--info {
    background: linear-gradient(135deg, var(--color-blue-500), var(--color-blue-600));
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(59, 130, 246, 0.4),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.1);
}

/* Surface - Light background with dark icon */
.fab--surface {
    background: white;
    color: var(--color-primary-500);
    box-shadow:
        0 var(--space-3) var(--space-3) rgba(0, 0, 0, 0.15),
        0 var(--space-1) var(--space-3) rgba(0, 0, 0, 0.08);
}

/* ==========================================================================
   Pulse Effect (for attention)
   ========================================================================== */

.fab--pulse {
    animation: fab-pulse 2s ease-in-out infinite;
}

/* Badge on FAB */
.fab-badge {
    position: absolute;
    top: calc(-1 * var(--space-1));
    right: calc(-1 * var(--space-1));
    min-width: var(--space-5);
    height: var(--space-5);
    padding: 0 var(--space-2);
    background: var(--color-red-500);
    color: white;
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid white;
}

/* ==========================================================================
   Speed Dial (Multiple Actions)
   ========================================================================== */

.fab-container {
    position: fixed;
    bottom: var(--space-6);
    right: var(--space-6);
    z-index: var(--z-toast);
}

.fab-actions {
    position: absolute;
    bottom: 70px;
    right: 0;
    display: flex;
    flex-direction: column-reverse;
    gap: var(--space-3);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity 0.2s ease,
        visibility 0.2s ease;
}

/* Show actions when expanded */
.fab-container.fab-expanded .fab-actions {
    opacity: 1;
    visibility: visible;
}

/* Individual action buttons */
.fab-action {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    opacity: 0;
    transform: scale(0) translateY(var(--space-5));
}

.fab-container.fab-expanded .fab-action {
    animation: fab-action-in 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* Stagger animation delay */
.fab-container.fab-expanded .fab-action:nth-child(1) { animation-delay: 0ms; }
.fab-container.fab-expanded .fab-action:nth-child(2) { animation-delay: 50ms; }
.fab-container.fab-expanded .fab-action:nth-child(3) { animation-delay: 100ms; }
.fab-container.fab-expanded .fab-action:nth-child(4) { animation-delay: 150ms; }
.fab-container.fab-expanded .fab-action:nth-child(5) { animation-delay: 200ms; }

/* Action button */
.fab-action-btn {
    width: var(--space-12);
    height: var(--space-12);
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    color: var(--color-gray-700);
    border: none;
    border-radius: var(--radius-full);
    font-size: var(--font-size-lg);
    cursor: pointer;
    box-shadow:
        0 var(--space-2) var(--space-2) rgba(0, 0, 0, 0.15),
        0 1px var(--space-2) rgba(0, 0, 0, 0.1);
    transition:
        transform 0.2s ease,
        background 0.2s ease;
}

.fab-action-btn:hover {
    transform: scale(1.1);
    background: var(--color-gray-100);
}

/* Action label */
.fab-action-label {
    background: white;
    color: var(--color-gray-700);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    white-space: nowrap;
    box-shadow: 0 var(--space-1) var(--space-2) rgba(0, 0, 0, 0.1);
    opacity: 0;
    transform: translateX(var(--space-3));
    transition:
        opacity 0.2s ease,
        transform 0.2s ease;
}

.fab-action:hover .fab-action-label {
    opacity: 1;
    transform: translateX(0);
}

/* Main FAB rotation when expanded */
.fab-container.fab-expanded .fab-main {
    transform: rotate(45deg);
}

.fab-main {
    transition:
        transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
        box-shadow 0.2s ease;
}

/* Overlay when expanded */
.fab-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.3);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity 0.3s ease,
        visibility 0.3s ease;
    z-index: calc(var(--z-toast) - 1);
}

.fab-container.fab-expanded .fab-overlay {
    opacity: 1;
    visibility: visible;
}

/* ==========================================================================
   Mobile Adjustments
   ========================================================================== */

@media (max-width: 768px) {
    .fab,
    .floating-action-button,
    .fab-container {
        bottom: var(--space-20); /* Above mobile nav */
        right: var(--space-4);
    }

    .fab--bottom-left,
    .fab-container.fab--bottom-left {
        left: var(--space-4);
    }

    /* Smaller on mobile */
    .fab,
    .fab--md {
        width: 52px;
        height: 52px;
        font-size: 22px;
    }

    .fab-actions {
        bottom: 66px;
    }

    .fab-action-label {
        display: none;
    }
}

/* ==========================================================================
   Dark Mode
   ========================================================================== */

[data-theme="dark"] .fab--surface {
    background: var(--color-gray-800);
    color: var(--color-primary-300);
}

[data-theme="dark"] .fab-action-btn {
    background: var(--color-gray-800);
    color: var(--color-gray-200);
    box-shadow:
        0 var(--space-2) var(--space-2) rgba(0, 0, 0, 0.3),
        0 1px var(--space-2) rgba(0, 0, 0, 0.2);
}

[data-theme="dark"] .fab-action-btn:hover {
    background: var(--color-gray-700);
}

[data-theme="dark"] .fab-action-label {
    background: var(--color-gray-800);
    color: var(--color-gray-200);
    box-shadow: 0 var(--space-1) var(--space-2) rgba(0, 0, 0, 0.2);
}

[data-theme="dark"] .fab-badge {
    border-color: var(--color-gray-800);
}

[data-theme="dark"] .fab-overlay {
    background: rgba(0, 0, 0, 0.5);
}

/* ==========================================================================
   Reduced Motion
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
    .fab.fab-animate-in,
    .floating-action-button.fab-animate-in {
        animation: none;
        opacity: 1;
        transform: scale(1);
    }

    .fab.fab-animate-out,
    .floating-action-button.fab-animate-out {
        animation: none;
    }

    .fab--pulse {
        animation: none;
    }

    .fab-container.fab-expanded .fab-action {
        animation: none;
        opacity: 1;
        transform: none;
    }

    .fab-main {
        transition: none;
    }
}

/* ==========================================================================
   Print - Hide FABs
   ========================================================================== */

@media print {
    .fab,
    .floating-action-button,
    .fab-container {
        display: none !important;
    }
}
