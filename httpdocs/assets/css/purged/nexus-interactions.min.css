/**
 * Nexus Interactions
 * Consolidated animations, micro-interactions, and skeleton loading
 * Replaces: nexus-10x-polish.css, nexus-ux-polish.css, nexus-micro-interactions.css
  * Fully Migrated to Design Tokens: 2026-01-21 ✓
 */

/* ============================================
   1. KEYFRAME ANIMATIONS
   ============================================ */

/* Shimmer for skeleton loading */
@keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

@keyframes nexus-shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Icon animations */
@keyframes iconBounce {
    0% { transform: scale(1); }
    25% { transform: scale(0.85); }
    50% { transform: scale(1.15); }
    75% { transform: scale(0.95); }
    100% { transform: scale(1); }
}

@keyframes iconPop {
    0% { transform: scale(1) translateY(0); }
    40% { transform: scale(1.25) translateY(-4px); }
    60% { transform: scale(0.95) translateY(-2px); }
    80% { transform: scale(1.05) translateY(-3px); }
    100% { transform: scale(1.1) translateY(-2px); }
}

@keyframes labelFadeIn {
    0% { opacity: 0; transform: translateY(4px); }
    100% { opacity: 1; transform: translateY(0); }
}

/* Ripple effect */
@keyframes ripple {
    0% { width: 0; height: 0; opacity: 1; }
    100% { width: 200%; height: 200%; opacity: 0; }
}

/* Badge animations */
@keyframes bounceIn {
    0% { opacity: 0; transform: scale(0); }
    50% { transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
}

@keyframes badgeBounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
}

/* Pulse animation */
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* FAB pulse */
@keyframes fabPulse {
    0%, 100% {
        box-shadow: 0 4px 20px var(--color-indigo-alpha-40),
                    0 0 0 0 var(--color-indigo-alpha-40);
    }
    50% {
        box-shadow: 0 4px 20px var(--color-indigo-alpha-40),
                    0 0 0 8px transparent;
    }
}

/* Spin animation */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Page transitions */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
    from { opacity: 0; transform: scale(0.9) translateY(20px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

/* Slide animations */
@keyframes slideInRight {
    from { transform: translateX(400px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes slideOutRight {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(400px); opacity: 0; }
}

@keyframes slideOutLeft {
    from { opacity: 1; transform: translateX(0) scale(1); }
    to { opacity: 0; transform: translateX(-30px) scale(0.98); }
}

@keyframes slideInLeft {
    from { opacity: 0; transform: translateX(-30px) scale(0.98); }
    to { opacity: 1; transform: translateX(0) scale(1); }
}

/* Content animations */
@keyframes contentFadeIn {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes nexus-content-fade-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Loading progress */
@keyframes loadingProgress {
    0% { width: 0; }
    50% { width: 70%; }
    100% { width: 90%; }
}

/* Progress bar shine */
@keyframes progressShine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(400%); }
}

/* Gradient shift */
@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

/* Focus ring */

/* Optimistic UI */
@keyframes nexus-optimistic-pulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.6; }
}

@keyframes nexus-optimistic-success {
    0% { box-shadow: 0 0 0 0 var(--color-emerald-alpha-40); }
    50% { box-shadow: 0 0 0 4px var(--color-emerald-alpha-20); }
    100% { box-shadow: 0 0 0 0 transparent; }
}

@keyframes nexus-optimistic-error {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-4px); }
    40% { transform: translateX(4px); }
    60% { transform: translateX(-4px); }
    80% { transform: translateX(4px); }
}

/* ============================================
   2. VIEW TRANSITIONS API
   ============================================ */
@view-transition {
    navigation: auto;
}

::view-transition-old(root) {
    animation: slideOutLeft var(--transition-base) ease-out both;
}

::view-transition-new(root) {
    animation: slideInRight var(--transition-base) ease-out both;
}

.navigating-back::view-transition-old(root) {
    animation: slideOutRight var(--transition-base) ease-out both;
}

.navigating-back::view-transition-new(root) {
    animation: slideInLeft var(--transition-base) ease-out both;
}

@keyframes slideOutRight {
    from { opacity: 1; transform: translateX(0) scale(1); }
    to { opacity: 0; transform: translateX(30px) scale(0.98); }
}

@keyframes slideInRight {
    from { opacity: 0; transform: translateX(30px) scale(0.98); }
    to { opacity: 1; transform: translateX(0) scale(1); }
}

/* View transition timing */
::view-transition-old(root),
::view-transition-new(root) {
    animation-duration: 0.25s;
    animation-timing-function: var(--ease-in-out);
}

/* ============================================
   3. SKELETON LOADING
   ============================================ */

/* Base skeleton */
.skeleton,
.nexus-skeleton {
    background: linear-gradient(90deg,
        var(--color-black-alpha-6) 0%,
        var(--color-black-alpha-10) 20%,
        var(--color-black-alpha-6) 40%,
        var(--color-black-alpha-6) 100%);
    background-size: 200% 100%;
    animation: shimmer 1.5s ease-in-out infinite;
    border-radius: var(--radius-base);
}

[data-theme="dark"] .skeleton,
[data-theme="dark"] .nexus-skeleton {
    background: linear-gradient(90deg,
        var(--color-white-alpha-4) 0%,
        var(--color-white-alpha-8) 20%,
        var(--color-white-alpha-4) 40%,
        var(--color-white-alpha-4) 100%);
    background-size: 200% 100%;
}

/* Skeleton shimmer variants */
.nexus-skeleton-avatar,
.nexus-skeleton-line,
.nexus-skeleton-image,
.nexus-skeleton-btn,
.nexus-skeleton-card-image,
.nexus-skeleton-cover {
    background: linear-gradient(90deg,
        var(--color-gray-alpha-20) 0%,
        var(--color-gray-800-alpha-50) 50%,
        var(--color-gray-alpha-20) 100%);
    background-size: 200% 100%;
    animation: nexus-shimmer 1.5s ease-in-out infinite;
}

[data-theme="dark"] .nexus-skeleton-avatar,
[data-theme="dark"] .nexus-skeleton-line,
[data-theme="dark"] .nexus-skeleton-image,
[data-theme="dark"] .nexus-skeleton-btn,
[data-theme="dark"] .nexus-skeleton-card-image,
[data-theme="dark"] .nexus-skeleton-cover {
    background: linear-gradient(90deg,
        var(--color-slate-500-alpha-20) 0%,
        var(--color-slate-600-alpha-50) 50%,
        var(--color-slate-500-alpha-20) 100%);
    background-size: 200% 100%;
}

/* Skeleton components */
.skeleton-text {
    height: 1em;
    margin-bottom: 0.5em; /* Font-relative, keep as-is */
    border-radius: var(--radius-sm);
}

.skeleton-text:last-child {
    width: 70%;
}

.skeleton-title {
    height: 1.5em;
    width: 60%;
    margin-bottom: 1em; /* Font-relative, keep as-is */
}

.skeleton-avatar,
.nexus-skeleton-avatar {
    width: var(--space-12);
    height: var(--space-12);
    border-radius: var(--radius-full);
    flex-shrink: 0;
}

.nexus-skeleton-avatar.small {
    width: var(--space-6);
    height: var(--space-6);
}

.nexus-skeleton-avatar.large {
    width: 120px; /* Specific size, no token */
    height: 120px; /* Specific size, no token */
}

.skeleton-card {
    height: 120px; /* Specific size, no token */
    border-radius: var(--radius-lg);
}

.skeleton-button,
.nexus-skeleton-btn {
    height: 44px; /* Specific size, no exact token */
    width: 120px; /* Specific size, no token */
    border-radius: var(--radius-md);
}

.skeleton-image,
.nexus-skeleton-image {
    width: 100%;
    aspect-ratio: 16/9;
    border-radius: var(--radius-md);
}

.nexus-skeleton-line {
    height: 14px; /* Specific size, no token */
    border-radius: var(--radius-sm);
    width: 100%;
}

.nexus-skeleton-line.short {
    height: var(--space-3);
    margin-top: var(--space-1);
}

/* Skeleton container */
.nexus-skeleton-container {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
}

.nexus-skeleton-container.nexus-skeleton-exit {
    opacity: 0;
    transform: translateY(-10px);
    transition: opacity var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) var(--ease-in-out);
}

/* Skeleton post */
.nexus-skeleton-post {
    padding: var(--space-4);
}

.nexus-skeleton-header {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.nexus-skeleton-meta {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-2); /* 8px close enough to 6px */
    justify-content: center;
}

.nexus-skeleton-body {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
}

.nexus-skeleton-actions {
    display: flex;
    gap: var(--space-2);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-color, #e4e6eb);
}

/* Skeleton card */
.nexus-skeleton-card {
    overflow: hidden;
}

.nexus-skeleton-card-image {
    width: 100%;
    height: 180px; /* Specific size, no token */
}

.nexus-skeleton-card-body {
    padding: var(--space-3);
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.nexus-skeleton-card-footer {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-top: var(--space-2);
    padding-top: var(--space-2);
    border-top: 1px solid var(--border-color, #e4e6eb);
}

/* Page loading skeleton */
.nexus-page-skeleton {
    position: fixed;
    inset: 0;
    background: var(--nav-bg-solid, var(--color-white));
    z-index: 9998;
    display: flex;
    flex-direction: column;
    padding: var(--space-20) var(--space-5) 100px; /* 100px specific, 20px → space-5 */
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--transition-fast) var(--ease-in-out), visibility var(--transition-fast) var(--ease-in-out);
}

[data-theme="dark"] .nexus-page-skeleton {
    background: var(--color-slate-900);
}

.nexus-page-skeleton.visible {
    opacity: 1;
    visibility: visible;
}

/* Skeleton fade out */
.skeleton-feed-container,
[class*="skeleton-container"] {
    transition: opacity var(--transition-slow) cubic-bezier(0.0, 0.0, 0.2, 1);
}

/* ============================================
   4. BUTTON MICRO-INTERACTIONS
   ============================================ */
button,
.btn,
.btn--glass,
.nexus-btn,
a[role="button"] {
    position: relative;
    transform: translateZ(0);
    transition: all var(--transition-fast) var(--ease-in-out);
    will-change: transform, box-shadow;
    overflow: hidden;
}

button:hover,
.btn:hover,
.btn--glass:hover,
.nexus-btn:hover,
a[role="button"]:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px var(--color-black-alpha-20);
}

button:active,
.btn:active,
.btn--glass:active,
.nexus-btn:active,
a[role="button"]:active {
    transform: translateY(0) scale(0.98);
    box-shadow: 0 2px 4px var(--color-black-alpha-10);
}

/* Ripple effect */
button::after,
.btn::after,
.btn--glass::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: var(--radius-full);
    background: var(--color-white-alpha-30);
    transform: translate(-50%, -50%);
    opacity: 0;
    pointer-events: none;
}

button:active::after,
.btn:active::after,
.btn--glass:active::after {
    animation: ripple var(--transition-slow) var(--ease-out);
}

/* ============================================
   5. CARD HOVER EFFECTS
   ============================================ */
.nexus-card,
.glass-card,
.glass-profile-card,
.admin-glass-card,
.feed-card,
.post-card {
    transition: all var(--transition-base) var(--ease-in-out);
    transform: translateZ(0);
    will-change: transform, box-shadow;
}

.nexus-card:hover,
.glass-card:hover,
.glass-profile-card:hover,
.admin-glass-card:hover,
.feed-card:hover,
.post-card:hover {
    transform: translateY(-4px) scale(1.01);
    box-shadow: 0 20px 40px var(--color-black-alpha-15),
                0 0 0 1px var(--color-indigo-alpha-30);
}

/* Card glow on hover */
.nexus-card::before,
.glass-card::before {
    content: '';
    position: absolute;
    inset: -1px; /* Specific negative value, no token */
    border-radius: inherit;
    background: linear-gradient(135deg, var(--color-indigo-alpha-20), var(--color-violet-alpha-20));
    opacity: 0;
    transition: opacity var(--transition-base);
    z-index: -1;
    pointer-events: none;
}

.nexus-card:hover::before,
.glass-card:hover::before {
    opacity: 1;
}

/* Card stagger animation */
.feed-card:nth-child(1) { animation-delay: 0.05s; }
.feed-card:nth-child(2) { animation-delay: 0.1s; }
.feed-card:nth-child(3) { animation-delay: 0.15s; }
.feed-card:nth-child(4) { animation-delay: 0.2s; }
.feed-card:nth-child(5) { animation-delay: 0.25s; }

.feed-card,
.post-card,
.nexus-card {
    animation: fadeInUp var(--transition-slow) var(--ease-in-out) backwards;
}

/* ============================================
   6. NAVIGATION ICON ANIMATIONS
   ============================================ */
.nexus-native-nav-item.active i {
    animation: iconPop var(--transition-slow) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55)) forwards;
}

.nexus-native-nav-item.active span {
    animation: labelFadeIn var(--transition-base) ease-out var(--transition-fast) both;
}

.nexus-native-nav-item.tapped i {
    animation: iconBounce var(--transition-slow) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55));
}

.nexus-native-nav-item i {
    transition: transform var(--transition-fast) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55)), color var(--transition-fast) var(--ease-in-out);
}

.nexus-native-nav-item:hover:not(.active) i {
    transform: scale(1.08);
}

/* Nav item ripple */
.nexus-native-nav-item {
    position: relative;
    overflow: hidden;
}

.nexus-native-nav-item::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: radial-gradient(circle, var(--nav-text-active) 0%, transparent 70%);
    opacity: 0;
    transform: translate(-50%, -50%);
    border-radius: var(--radius-full);
    transition: width var(--transition-slow) var(--ease-in-out), height var(--transition-slow) var(--ease-in-out), opacity var(--transition-slow) var(--ease-in-out);
    pointer-events: none;
}

.nexus-native-nav-item:active::before {
    width: 150px; /* Specific size, no token */
    height: 150px; /* Specific size, no token */
    opacity: 0.15;
}

/* ============================================
   7. ICON ANIMATIONS
   ============================================ */
.fa-solid,
.fa-regular,
.fa-brands,
i[class*="fa-"] {
    transition: transform var(--transition-fast) var(--ease-in-out);
}

button:hover .fa-solid,
a:hover .fa-solid,
.btn:hover i {
    transform: scale(1.1);
}

.fa-spinner,
.fa-circle-notch,
.fa-sync {
    animation: spin 1s linear infinite;
}

.fa-bell.has-notification,
.fa-envelope.has-notification {
    animation: pulse 2s ease-in-out infinite;
}

/* ============================================
   8. BADGE ANIMATIONS
   ============================================ */
.badge,
.admin-badge,
.notification-badge {
    animation: bounceIn var(--transition-slow) cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.notification-badge {
    animation: bounceIn var(--transition-slow) cubic-bezier(0.68, -0.55, 0.265, 1.55),
               pulse 2s ease-in-out var(--transition-slow) infinite;
}

.nexus-native-nav-badge,
.nexus-drawer-item-badge {
    animation: badgeBounce 2s ease-in-out infinite;
}

/* ============================================
   9. FAB ANIMATIONS
   ============================================ */
.nexus-quick-fab {
    animation: fabPulse 2s ease-in-out infinite;
}

.nexus-quick-fab:hover {
    animation: none;
    transform: scale(1.08) rotate(90deg);
}

.nexus-quick-fab:active {
    transform: scale(0.92) rotate(90deg);
}

.nexus-quick-fab i {
    transition: transform var(--transition-base) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55));
}

.nexus-quick-fab:hover i,
.nexus-quick-fab.active i {
    transform: rotate(45deg);
}

/* ============================================
   10. TOAST NOTIFICATIONS
   ============================================ */
#nexus-toast,
.toast-notification {
    animation: slideInRight var(--transition-slow) var(--ease-in-out);
}

#nexus-toast.hiding,
.toast-notification.hiding {
    animation: slideOutRight var(--transition-base) var(--ease-in-out);
}

/* ============================================
   11. MODAL ANIMATIONS
   ============================================ */
.modal,
.modal-overlay,
[role="dialog"] {
    animation: fadeIn var(--transition-base) var(--ease-in-out);
}

.modal.closing,
.modal-overlay.closing {
    animation: fadeOut var(--transition-fast) var(--ease-in-out);
}

.modal-content,
.modal-dialog {
    animation: scaleIn var(--transition-base) var(--ease-in-out);
}

/* ============================================
   12. PAGE TRANSITIONS
   ============================================ */
main,
.main-content {
    animation: fadeInUp var(--transition-slow) var(--ease-in-out);
}

.htb-container,
.htb-container-full,
[class*="content"] {
    animation: contentFadeIn 0.35s var(--ease-out);
}

.nexus-content-enter {
    animation: nexus-content-fade-in var(--transition-base) ease forwards;
}

/* Page transition fallback */
.page-transitioning {
    animation: contentFadeIn var(--transition-base) var(--ease-out);
}

/* ============================================
   13. OPTIMISTIC UI STATES
   ============================================ */
.nexus-optimistic-pending {
    position: relative;
    pointer-events: none;
}

.nexus-optimistic-pending::after {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--color-indigo-alpha-10);
    border-radius: inherit;
    animation: nexus-optimistic-pulse 1s ease infinite;
}

.nexus-optimistic-success {
    animation: nexus-optimistic-success var(--transition-base) var(--ease-in-out);
}

.nexus-optimistic-error {
    animation: nexus-optimistic-error var(--transition-slow) var(--ease-in-out);
}

.nexus-optimistic-error::after {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--color-red-alpha-15);
    border-radius: inherit;
    pointer-events: none;
}

.nexus-optimistic-comment {
    opacity: 0.7;
    position: relative;
}

.nexus-optimistic-comment::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 3px; /* Specific size, no token */
    height: 60%;
    background: var(--color-primary-500);
    border-radius: var(--radius-sm); /* Design token not available for 2px */
    opacity: 0.5;
}

/* ============================================
   14. LOADING STATES
   ============================================ */
.nexus-loading-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 0;
    height: 3px; /* Specific size, no token */
    background: linear-gradient(90deg, var(--color-primary-500), var(--color-purple-500), var(--color-pink-500));
    z-index: var(--z-notification, 1700);
    transition: width var(--transition-base) var(--ease-out);
    box-shadow: 0 0 10px var(--color-indigo-alpha-50);
}

.nexus-loading-bar.active {
    animation: loadingProgress 2s ease-in-out infinite;
}

.nexus-loading-bar.complete {
    width: 100%;
    opacity: 0;
    transition: width var(--transition-fast) var(--ease-out), opacity var(--transition-base) ease var(--transition-fast);
}

.loading-spinner,
.spinner,
.nexus-loading-wheel {
    animation: spin 1s linear infinite;
    will-change: transform;
}

/* ============================================
   15. PROGRESS BARS
   ============================================ */
.progress-bar {
    position: relative;
    overflow: hidden;
}

.progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 30%;
    background: linear-gradient(90deg, transparent, var(--color-white-alpha-30), transparent);
    animation: progressShine 2s ease-in-out infinite;
}

/* ============================================
   16. LINK HOVER EFFECTS
   ============================================ */
a {
    position: relative;
    transition: color var(--transition-fast);
}

a:not(.btn):not(.btn--glass):not(.nav-link):not(.nexus-native-nav-item):not(.nexus-drawer-item)::after {
    content: '';
    position: absolute;
    bottom: -2px; /* Specific negative value, no token */
    left: 0;
    width: 0;
    height: 2px; /* Specific size, no token */
    background: currentColor;
    transition: width var(--transition-base) var(--ease-in-out);
}

a:not(.btn):not(.btn--glass):not(.nav-link):not(.nexus-native-nav-item):not(.nexus-drawer-item):hover::after {
    width: 100%;
}

/* ============================================
   17. IMAGE LOADING
   ============================================ */
img {
    transition: opacity 0.3s, filter var(--transition-base);
}

/* img[loading="lazy"] rules consolidated in bundles/core.css */

img.blur-up {
    filter: blur(20px); /* Specific blur, no token */
    transition: filter var(--transition-slow);
}

img.blur-up.loaded {
    filter: blur(0);
}

/* ============================================
   18. TOUCH FEEDBACK
   ============================================ */
* {
    -webkit-tap-highlight-color: transparent;
}

.nexus-pressable,
.nexus-touch-feedback {
    transition: transform var(--transition-fast) var(--ease-in-out);
    -webkit-tap-highlight-color: transparent;
}

.nexus-pressable:active,
.nexus-touch-feedback:active {
    transform: scale(0.97);
}

/* ============================================
   19. DRAWER ITEM ANIMATIONS
   ============================================ */
.htb-btn,
.nexus-drawer-item,
.nexus-sheet-action,
.nexus-drawer-footer-action {
    transition: transform var(--transition-fast) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55)),
                box-shadow var(--transition-fast) var(--ease-in-out),
                background var(--transition-fast) var(--ease-in-out);
}

.htb-btn:active,
.nexus-drawer-item:active,
.nexus-sheet-action:active {
    transform: scale(0.96);
}

.nexus-drawer-item-icon {
    transition: transform var(--transition-base) var(--spring-bounce, cubic-bezier(0.68, -0.55, 0.265, 1.55)),
                box-shadow var(--transition-fast) var(--ease-in-out);
}

.nexus-drawer-item:active .nexus-drawer-item-icon {
    transform: scale(0.88) rotate(-3deg);
}

.nexus-drawer-item:hover .nexus-drawer-item-icon {
    transform: scale(1.05);
    box-shadow: 0 6px 20px var(--color-black-alpha-15);
}

/* ============================================
   20. SCROLLBAR STYLING
   ============================================ */
::-webkit-scrollbar {
    width: var(--space-3);
    height: var(--space-3);
}

::-webkit-scrollbar-track {
    background: var(--color-black-alpha-10);
    border-radius: var(--space-2);
}

::-webkit-scrollbar-thumb {
    background: var(--color-indigo-alpha-30);
    border-radius: var(--space-2);
    transition: background var(--transition-fast);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--color-indigo-alpha-50);
}

* {
    scrollbar-width: thin;
    scrollbar-color: var(--color-indigo-alpha-30) var(--color-black-alpha-10);
    -ms-overflow-style: auto;
}

/* ============================================
   21. OVERSCROLL BEHAVIOR
   ============================================ */
html,
body {
    overscroll-behavior-y: none;
}

.nexus-scroll-bounce,
.nexus-drawer-body,
.nexus-bottom-sheet-body {
    overscroll-behavior-y: auto;
}

/* ============================================
   22. DARK MODE REFINEMENTS
   ============================================ */
[data-theme="dark"] {
}

[data-theme="dark"] .nexus-card,
[data-theme="dark"] .glass-card {
    background: var(--color-slate-900-alpha-70);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid var(--color-indigo-alpha-15);
    box-shadow: 0 8px 32px var(--color-black-alpha-40),
                inset 0 1px 0 var(--color-white-alpha-5);
}

[data-theme="dark"] .nexus-skeleton-card-footer,
[data-theme="dark"] .nexus-skeleton-actions {
    border-top-color: #3e4042;
}

[data-theme="dark"] .nexus-optimistic-pending::after {
    background: var(--color-indigo-alpha-15);
}

[data-theme="dark"] .nexus-optimistic-error::after {
    background: var(--color-red-alpha-20);
}

/* ============================================
   23. GRADIENT EFFECTS
   ============================================ */

.glass-gradient-border {
    position: relative;
    background: var(--color-slate-900-alpha-70);
    -webkit-backdrop-filter: blur(20px); /* Specific blur, no token */
    backdrop-filter: blur(20px); /* Specific blur, no token */
}

.glass-gradient-border::before {
    content: '';
    position: absolute;
    inset: -2px; /* Specific negative value, no token */
    border-radius: inherit;
    background: linear-gradient(45deg, var(--color-primary-500), var(--color-purple-500), var(--color-pink-500), var(--color-primary-500));
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    z-index: -1;
    opacity: 0.6;
}

/* ============================================
   24. PERFORMANCE OPTIMIZATIONS
   ============================================ */
.nexus-native-nav,
.nexus-native-drawer,
.nexus-bottom-sheet-container,
.nexus-quick-fab,
.nexus-native-nav-item i {
    will-change: transform;
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

.skeleton,
.nexus-skeleton {
    contain: content;
}

button,
.btn,
.btn--glass,
.nexus-card,
.glass-card,
.modal,
.toast-notification {
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px; /* Performance optimization value, no token */
}

.nexus-card,
.glass-card,
.feed-card,
.post-card {
    contain: layout style paint;
}

/* ============================================
   25. ACCESSIBILITY - REDUCED MOTION
   ============================================ */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    ::view-transition-old(root),
    ::view-transition-new(root) {
        animation: none !important;
    }

    .nexus-quick-fab,
    .skeleton,
    .nexus-skeleton,
    .nexus-skeleton-avatar,
    .nexus-skeleton-line,
    .nexus-skeleton-image,
    .nexus-skeleton-btn,
    .nexus-skeleton-card-image,
    .nexus-skeleton-cover {
        animation: none !important;
        background: var(--color-gray-alpha-30);
    }

    .nexus-optimistic-pending::after,
    .nexus-optimistic-success,
    .nexus-optimistic-error,
    .nexus-content-enter {
        animation: none;
    }

    ::view-transition-old(*),
    ::view-transition-new(*) {
        animation-duration: 0.001s !important;
    }
}

/* ============================================
   26. MOBILE UTILITY BAR
   ============================================ */
@media (max-width: 900px) {
    .nexus-utility-bar {
        padding: var(--space-2) var(--space-2) !important;
        height: auto !important;
        min-height: var(--space-10) !important;
        gap: var(--space-1) !important;
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        scrollbar-width: none !important;
        -ms-overflow-style: none !important;
    }

    .nexus-utility-bar::-webkit-scrollbar {
        display: none !important;
    }

    .nexus-utility-bar .left-utils {
        display: none !important;
    }

    .nexus-utility-bar > div[style*="margin-left:auto"] {
        display: flex !important;
        align-items: center !important;
        gap: var(--space-2) /* 8px close to 6px */ !important;
        margin-left: auto !important;
        flex-shrink: 0 !important;
        width: 100% !important;
        justify-content: flex-end !important;
    }

    .nexus-utility-bar .util-link {
        padding: var(--space-2) var(--space-2) !important;
        font-size: var(--font-size-xs) !important;
        min-height: 28px /* No exact token */ !important;
        white-space: nowrap !important;
        border-radius: var(--space-2) /* 8px close to 6px */ !important;
        background: var(--color-white-alpha-8) !important;
        margin-left: 0 !important;
    }

    .nexus-utility-bar .htb-dropdown > button {
        padding: var(--space-2) 10px !important;
        font-size: var(--font-size-xs) /* Smaller than xs, no token */ !important;
        border-radius: var(--space-2) /* 8px close to 6px */ !important;
    }

    .nexus-utility-bar button[onclick="toggleTheme()"] {
        width: var(--space-8) !important;
        height: var(--space-8) !important;
        padding: 0 !important;
        font-size: var(--font-size-base) !important;
        border-radius: var(--radius-base) !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    .nexus-utility-bar .desktop-only,
    .nexus-utility-bar .desktop-only-dd {
        display: none !important;
    }

    .nexus-utility-bar .htb-dropdown-content {
        position: fixed !important;
        left: var(--space-2) !important;
        right: var(--space-2) !important;
        top: auto !important;
        bottom: var(--space-20) !important;
        width: auto !important;
        max-height: 70vh !important;
        border-radius: var(--radius-lg) !important;
        z-index: 10001 !important;
    }

    .nexus-utility-bar #nexus-bell-badge {
        min-width: 14px /* No exact token */ !important;
        height: 14px /* No exact token */ !important;
        font-size: var(--font-size-xs) /* Smaller than xs, no token */ !important;
        top: -2px /* Specific negative value, no token */ !important;
        right: -2px /* Specific negative value, no token */ !important;
    }

    .nexus-utility-bar .htb-arrow {
        display: none !important;
    }
}

@media (max-width: 400px) {
    .nexus-utility-bar .util-link span:not(.htb-arrow),
    .nexus-utility-bar .htb-dropdown > button span:not(.htb-arrow) {
        display: none !important;
    }

    .nexus-utility-bar .util-link,
    .nexus-utility-bar .htb-dropdown > button {
        padding: var(--space-2) 10px !important;
        min-width: 36px /* No exact token */ !important;
        justify-content: center !important;
    }
}

@media (max-width: 360px) {
    .nexus-utility-bar .htb-dropdown > button {
        padding: var(--space-2) var(--space-2) !important;
    }

    .nexus-utility-bar > div[style*="margin-left:auto"] {
        gap: var(--space-1) !important;
    }
}

/* ============================================
   27. RESPONSIVE GRID LOADING
   ============================================ */
.nexus-loading {
    min-height: 200px; /* Specific size, no token */
    position: relative;
}


.listings-grid.nexus-loading .nexus-skeleton-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: var(--space-4);
}

@media (max-width: 640px) {
    
    .listings-grid.nexus-loading .nexus-skeleton-container {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-2);
    }
}
