/**
 * Layout Isolation CSS
 * Prevents visual glitches during layout switching by scoping layout-specific styles
 * and ensuring clean transitions between Modern and CivicOne layouts
 */

/* === LAYOUT SCOPING === */
/* Scope layout-specific styles to prevent conflicts */

/* Modern Layout Isolation */
html[data-layout="modern"] {
    /* Modern layout uses these CSS files exclusively */
    /* Prevent CivicOne styles from bleeding in */
}

/* CivicOne Layout Isolation */
html[data-layout="civicone"] {
    /* CivicOne layout uses these CSS files exclusively */
    /* Prevent Modern styles from bleeding in */
}

/* === LAYOUT SWITCHING TRANSITIONS === */
/* Smooth transition during layout switch to prevent flash of unstyled content */

html {
    /* Prevent flash during layout switch */
    transition: none !important;
}

/* Body transition for smooth layout changes */
body {
    /* Prevent layout shift during CSS loading */
    min-height: 100vh;
    position: relative;
}

/* === PREVENT CSS CONFLICTS === */

/* Reset conflicting styles between layouts */
html[data-layout="modern"] .civic-only,
html[data-layout="civicone"] .modern-only {
    display: none !important;
}

/* === LOADING STATE === */
/* Show loading indicator during layout switch to prevent visual glitches */

html.layout-switching {
    cursor: wait;
}

html.layout-switching body {
    opacity: 0.95;
    pointer-events: none;
}

/* === CACHE-BUSTING SUPPORT === */
/* Ensure CSS files are properly refreshed during layout switch */

/* Force repaint after layout switch */
/* NOTE: Removed transform: translateZ(0) as it breaks position: fixed on descendants */
/* Using will-change on specific elements instead for GPU acceleration */
html[data-layout] {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    /* transform: translateZ(0) removed - breaks fixed positioning for bottom nav */
}

/* === MODERN LAYOUT SPECIFIC RESETS === */
html[data-layout="modern"] {
    /* Reset any CivicOne-specific variables */
    --civic-brand-primary: initial;
    --civic-brand-secondary: initial;
}

/* === CIVICONE LAYOUT SPECIFIC RESETS === */
html[data-layout="civicone"] {
    /* Reset any Modern-specific variables */
    --color-brand: initial;
    --color-accent: initial;
}

/* === PREVENT FOUC (Flash of Unstyled Content) === */
/* This ensures smooth visual transition when switching layouts */

.layout-transition-guard {
    visibility: hidden;
    opacity: 0;
    transition: opacity var(--transition-fast) var(--ease-in-out), visibility 0s var(--transition-fast);
}

.layout-transition-guard.loaded {
    visibility: visible;
    opacity: 1;
    transition: opacity var(--transition-fast) var(--ease-in-out);
}

/* === HEADER ISOLATION === */
/* Prevent header styles from conflicting between layouts */

html[data-layout="modern"] .civicone-header,
html[data-layout="civicone"] .modern-header {
    display: none !important;
}

/* === NAVIGATION ISOLATION === */
/* Ensure navigation styles don't conflict */

html[data-layout="modern"] .civicone-nav,
html[data-layout="civicone"] .modern-nav {
    display: none !important;
}

/* === MOBILE BOTTOM NAV ISOLATION === */
html[data-layout="modern"] .civicone-bottom-nav {
    display: none !important;
}

/* === UTILITY BAR ISOLATION === */
html[data-layout="civicone"] .modern-utility-bar {
    display: none !important;
}
