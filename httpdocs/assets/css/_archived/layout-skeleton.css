/**
 * Layout Skeleton - Critical Above-the-Fold Structure
 * Prevents Cumulative Layout Shift (CLS)
 * Loaded inline in <head> for instant rendering
 */

/* ==========================================
   BASE LAYOUT STRUCTURE
   Pre-define dimensions before content loads
   ========================================== */

.layout-container {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header - Fixed dimensions prevent CLS */
.nexus-header,
.nexus-modern-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--layout-header-height, 56px);
    z-index: var(--z-fixed, 1200);
    will-change: transform;
}

/* Main content area with proper offset */
.main-content {
    margin-top: var(--layout-header-height, 56px);
    flex: 1;
    width: 100%;
}

/* Grid layout skeleton */
.post-box-grid,
.home-two-column-grid {
    display: grid;
    grid-template-columns: 1fr var(--layout-sidebar-width, 340px);
    gap: var(--layout-grid-gap, 24px);
    max-width: var(--layout-max-content-width, 1200px);
    margin: 0 auto;
    padding: var(--space-5, 20px);
}

/* Mobile bottom navigation space */
@media (max-width: 768px) {
    .main-content {
        padding-bottom: calc(var(--layout-mobile-nav-height, 84px) + 16px);
    }

    .post-box-grid,
    .home-two-column-grid {
        grid-template-columns: 1fr;
        gap: var(--layout-grid-gap-mobile, 12px);
        padding: var(--space-3, 12px);
    }
}

@media (max-width: 1024px) and (min-width: 769px) {
    .post-box-grid,
    .home-two-column-grid {
        grid-template-columns: 1fr var(--layout-sidebar-width-tablet, 300px);
    }
}

/* ==========================================
   SKELETON LOADING STATES
   Shimmer animation for content placeholders
   ========================================== */

@keyframes skeleton-shimmer {
    0% {
        background-position: -1000px 0;
    }
    100% {
        background-position: 1000px 0;
    }
}

.skeleton {
    background: linear-gradient(
        90deg,
        var(--color-gray-200, #e5e7eb) 0%,
        var(--color-gray-100, #f3f4f6) 50%,
        var(--color-gray-200, #e5e7eb) 100%
    );
    background-size: 2000px 100%;
    animation: skeleton-shimmer 2s infinite linear;
    border-radius: var(--radius-base, 8px);
}

[data-theme="dark"] .skeleton {
    background: linear-gradient(
        90deg,
        rgba(255, 255, 255, 0.05) 0%,
        rgba(255, 255, 255, 0.1) 50%,
        rgba(255, 255, 255, 0.05) 100%
    );
}

/* Skeleton components */
.skeleton-header {
    height: var(--layout-header-height, 56px);
    width: 100%;
}

.skeleton-card {
    height: 200px;
    margin-bottom: var(--space-4, 16px);
}

.skeleton-text {
    height: 16px;
    margin-bottom: var(--space-2, 8px);
}

.skeleton-text:last-child {
    width: 60%;
}

.skeleton-avatar {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full, 9999px);
}

.skeleton-button {
    height: 40px;
    width: 120px;
    border-radius: var(--radius-md, 12px);
}

/* ==========================================
   SKELETON FEED LAYOUT
   Matches actual feed item dimensions
   ========================================== */

.skeleton-feed-item {
    background: var(--glass-bg-light, rgba(255, 255, 255, 0.7));
    backdrop-filter: blur(var(--glass-blur-subtle, 12px));
    border-radius: var(--radius-xl, 20px);
    padding: var(--space-4, 16px);
    margin-bottom: var(--space-4, 16px);
    border: 1px solid var(--glass-border-light, rgba(255, 255, 255, 0.2));
}

.skeleton-feed-header {
    display: flex;
    gap: var(--space-3, 12px);
    margin-bottom: var(--space-4, 16px);
}

.skeleton-feed-content {
    margin-bottom: var(--space-4, 16px);
}

.skeleton-feed-actions {
    display: flex;
    gap: var(--space-4, 16px);
}

/* ==========================================
   SIDEBAR SKELETON
   ========================================== */

.skeleton-sidebar {
    position: sticky;
    top: calc(var(--layout-header-height, 56px) + 20px);
}

.skeleton-sidebar-card {
    background: var(--glass-bg-light, rgba(255, 255, 255, 0.7));
    backdrop-filter: blur(var(--glass-blur-subtle, 12px));
    border-radius: var(--radius-xl, 20px);
    padding: var(--space-4, 16px);
    margin-bottom: var(--space-4, 16px);
    height: 240px;
}

@media (max-width: 768px) {
    .skeleton-sidebar {
        display: none;
    }
}

/* ==========================================
   LOADING STATE VISIBILITY
   Hide skeletons when content loads
   ========================================== */

.content-loaded .skeleton,
.content-loaded .skeleton-feed-item,
.content-loaded .skeleton-sidebar-card {
    display: none;
}

/* ==========================================
   ACCESSIBILITY
   ========================================== */

.skeleton,
.skeleton-feed-item,
.skeleton-sidebar-card {
    /* Announce to screen readers */
    position: relative;
}

.skeleton::after,
.skeleton-feed-item::after,
.skeleton-sidebar-card::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
}

/* Add aria-label for screen readers */
[aria-label="Loading..."] {
    /* Screen reader only text */
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
    .skeleton,
    .skeleton-feed-item,
    .skeleton-sidebar-card {
        animation: none;
        background: var(--color-gray-200, #e5e7eb);
    }

    [data-theme="dark"] .skeleton,
    [data-theme="dark"] .skeleton-feed-item,
    [data-theme="dark"] .skeleton-sidebar-card {
        background: rgba(255, 255, 255, 0.05);
    }
}

/* ==========================================
   HYDRATION CLASSES
   Smooth transition when content loads
   ========================================== */

.skeleton-container {
    opacity: 1;
    transition: opacity var(--transition-base, 300ms);
}

.skeleton-container.hydrated {
    opacity: 0;
    pointer-events: none;
}

.actual-content {
    opacity: 0;
    transition: opacity var(--transition-base, 300ms);
}

.actual-content.hydrated {
    opacity: 1;
}
