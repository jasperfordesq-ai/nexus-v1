/* mobile.min.css - Mobile navigation - load with media query */
/* Generated: 2026-01-31 12:58:14 */

/* === nexus-mobile.css === */
/**
 * Project NEXUS - Mobile Native App Experience
 * Includes: Bottom nav, page transitions, skeleton loaders, swipe gestures
  * Fully Migrated to Design Tokens: 2026-01-21 ✓
 */

/* ============================================
   MOBILE VIEWPORT FIX - Prevent content overflow
   ============================================ */
@media (max-width: 768px) {
    html {
        overflow-x: hidden !important;
        overflow-y: scroll !important;
        max-width: 100vw !important;
    }

    body {
        overflow-x: hidden !important;
        overflow-y: visible !important;
        max-width: 100vw !important;
        min-height: 100vh !important;
        position: relative !important;
        /* Allow normal overscroll behavior for smooth scrolling */
        overscroll-behavior-y: auto;
    }

    img,
    video,
    iframe,
    table,
    pre {
        max-width: 100% !important;
    }

    /* Hide site footer on mobile - content moved to Legal/More page */
    .nexus-site-footer,
    .nexus-modern-footer,
    footer.nexus-site-footer,
    footer[class*="nexus-site-footer"],
    .nexus-desktop-only {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        max-height: 0 !important;
        overflow: hidden !important;
        padding: 0 !important;
        margin: 0 !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }
}

/* Explicit desktop-only utility class */
@media (max-width: 768px) {
    .nexus-desktop-only {
        display: none !important;
    }
}

/* ============================================
   1. PERSISTENT BOTTOM TAB NAVIGATION
   ============================================ */

.nexus-bottom-nav {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: var(--z-fixed, 1200);
    background: var(--color-white-alpha-95);
    -webkit-backdrop-filter: blur(20px);
    backdrop-filter: blur(20px);
    border-top: 1px solid var(--border-subtle);
    padding: var(--space-2) 0;
    padding-bottom: max(var(--space-2), env(safe-area-inset-bottom));
    box-shadow: 0 -4px 20px var(--color-black-alpha-8);
}

[data-theme="dark"] .nexus-bottom-nav {
    background: var(--color-slate-900-alpha-95);
    border-top-color: var(--color-white-alpha-10);
}

.nexus-bottom-nav-inner {
    display: flex;
    justify-content: space-around;
    align-items: center;
    max-width: 500px;
    margin: 0 auto;
}

.nexus-bottom-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-2) var(--space-4);
    text-decoration: none;
    color: var(--color-slate-500);
    font-size: var(--font-size-xs);
    font-weight: 600;
    transition: all var(--transition-fast);
    position: relative;
    -webkit-tap-highlight-color: transparent;
}

.nexus-bottom-nav-item i {
    font-size: var(--font-size-xl);
    transition: all var(--transition-fast);
}

.nexus-bottom-nav-item.active {
    color: var(--color-primary-500);
}

.nexus-bottom-nav-item.active i {
    transform: scale(1.1);
}

[data-theme="dark"] .nexus-bottom-nav-item {
    color: var(--color-slate-400);
}

[data-theme="dark"] .nexus-bottom-nav-item.active {
    color: var(--color-primary-400);
}

/* Badge for notifications */
.nexus-bottom-nav-badge {
    position: absolute;
    top: 2px;
    right: var(--space-2);
    min-width: 18px;
    height: 18px;
    background: var(--color-danger);
    color: white;
    font-size: var(--font-size-xs);
    font-weight: 700;
    border-radius: var(--radius-base);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 var(--space-1);
}

/* Ripple effect */
.nexus-bottom-nav-item::after {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0;
    border-radius: var(--radius-md);
    transition: opacity var(--transition-fast);
}

.nexus-bottom-nav-item:active::after {
    opacity: 0.1;
}

/* Unified mobile breakpoint at 900px */
@media (max-width: 900px) {

    /* DISABLED: Using nexus-native-nav-v2 instead */
    /* .nexus-bottom-nav is now hidden by nexus-native-nav-v2.css */
    .nexus-bottom-nav {
        display: none !important;
    }

    /* Add padding to body to prevent content from being hidden */
    body.has-bottom-nav,
    body.nexus-native-nav-enabled {
        padding-bottom: calc(90px + env(safe-area-inset-bottom));
    }

    /* Hide desktop footer on mobile when bottom nav is present */
    body.has-bottom-nav .site-footer {
        display: none;
    }
}


/* ============================================
   2. PAGE TRANSITION ANIMATIONS - REMOVED
   ============================================ */
/* View Transitions caused glitches and have been removed for stability. */


/* ============================================
   3. SKELETON LOADERS
   ============================================ */

.skeleton {
    background: linear-gradient(90deg,
            var(--color-gray-300-alpha-20) 0%,
            var(--color-gray-300-alpha-40) 50%,
            var(--color-gray-300-alpha-20) 100%);
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.5s ease-in-out infinite;
    border-radius: var(--radius-base);
}

[data-theme="dark"] .skeleton {
    background: linear-gradient(90deg,
            var(--color-gray-500-alpha-20) 0%,
            var(--color-gray-500-alpha-40) 50%,
            var(--color-gray-500-alpha-20) 100%);
    background-size: 200% 100%;
}

@keyframes skeleton-shimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

/* Skeleton shapes */
.skeleton-text {
    height: 1em;
    margin-bottom: var(--space-2);
}

.skeleton-text:last-child {
    width: 70%;
}

.skeleton-title {
    height: 1.5em;
    width: 60%;
    margin-bottom: var(--space-4);
}

.skeleton-avatar {
    width: var(--space-12);
    height: var(--space-12);
    border-radius: 50%;
}

.skeleton-card {
    height: 120px;
    border-radius: var(--radius-lg);
}

.skeleton-image {
    width: 100%;
    aspect-ratio: 16/9;
    border-radius: var(--radius-md);
}

.skeleton-button {
    height: 44px;
    width: 120px;
    border-radius: var(--radius-md);
}

/* Skeleton card component */
.skeleton-card-full {
    padding: var(--space-5);
    background: var(--color-white-alpha-80);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-black-alpha-5);
}

[data-theme="dark"] .skeleton-card-full {
    background: var(--color-slate-800-alpha-80);
    border-color: var(--color-white-alpha-10);
}

.skeleton-card-full .skeleton-header {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.skeleton-card-full .skeleton-body {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}


/* ============================================
   4. PULL-TO-REFRESH - REMOVED
   ============================================ */
/* Pull-to-refresh feature has been permanently removed due to conflicts with scrolling */


/* ============================================
   5. SWIPE GESTURES
   ============================================ */

.nexus-swipe-container {
    touch-action: pan-y;
    overflow-x: hidden;
}

/* Swipe-to-go-back indicator */
.nexus-swipe-back-indicator {
    position: fixed;
    left: 0;
    top: 50%;
    transform: translateY(-50%) translateX(-60px) scale(0.8);
    width: 44px;
    height: 44px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    box-shadow:
        0 4px 20px var(--color-black-alpha-15),
        0 0 0 1px var(--color-black-alpha-5);
    z-index: var(--z-modal, 1400);
    pointer-events: none;
    transition: opacity var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) var(--ease-in-out);
    will-change: transform, opacity;
}

[data-theme="dark"] .nexus-swipe-back-indicator {
    background: var(--color-slate-800);
    box-shadow:
        0 4px 20px var(--color-black-alpha-30),
        0 0 0 1px var(--color-white-alpha-10);
}

.nexus-swipe-back-indicator.visible {
    opacity: 1;
}

.nexus-swipe-back-indicator.ready {
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
    box-shadow:
        0 4px 24px var(--color-indigo-alpha-40),
        0 0 0 4px var(--color-indigo-alpha-10);
}

.nexus-swipe-back-indicator.ready i {
    color: white;
}

.nexus-swipe-back-indicator.navigating {
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
    transition: transform var(--transition-fast) var(--ease-out);
}

.nexus-swipe-back-indicator i {
    color: var(--color-primary-500);
    font-size: var(--font-size-lg);
    transition: color var(--transition-fast) var(--ease-in-out);
}

[data-theme="dark"] .nexus-swipe-back-indicator i {
    color: var(--color-primary-400);
}

/* Swipe-back page overlay */
.nexus-swipe-back-overlay {
    position: fixed;
    inset: 0;
    background: black;
    opacity: 0;
    z-index: var(--z-modal-backdrop, 1300);
    pointer-events: none;
    transition: opacity var(--transition-fast) var(--ease-in-out);
}

.nexus-swipe-back-overlay.visible {
    /* Opacity controlled by JS */
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .nexus-swipe-back-indicator {
        transition: opacity var(--transition-fast);
    }

    .nexus-swipe-back-overlay {
        transition: none;
    }
}

/* Swipeable list items */
.nexus-swipe-item {
    position: relative;
    overflow: hidden;
    touch-action: pan-x;
}

.nexus-swipe-item-content {
    position: relative;
    background: white;
    transition: transform var(--transition-fast);
    z-index: 2;
}

[data-theme="dark"] .nexus-swipe-item-content {
    background: var(--color-slate-800);
}

.nexus-swipe-item-actions {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: stretch;
    z-index: 1;
}

.nexus-swipe-action {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 var(--space-5);
    color: white;
    font-weight: 600;
    font-size: var(--font-size-sm);
}

.nexus-swipe-action.delete {
    background: var(--color-danger);
}

.nexus-swipe-action.archive {
    background: var(--color-warning);
}

.nexus-swipe-action.edit {
    background: var(--color-primary-500);
}


/* ============================================
   6. ENHANCED TOUCH FEEDBACK
   ============================================ */

/* Disable tap highlight */
* {
    -webkit-tap-highlight-color: transparent;
}

/* Touch-friendly hover states */
@media (hover: none) and (pointer: coarse) {

    .htb-btn:hover,
    .htb-card:hover {
        transform: none;
        box-shadow: inherit;
    }
}

/* Active states for touch */
.nexus-touch-active {
    transform: scale(0.98);
    opacity: 0.9;
}

/* Pressable items */
.nexus-pressable {
    cursor: pointer;
    transition: transform 0.1s, opacity var(--transition-fast);
    -webkit-user-select: none;
    user-select: none;
}

.nexus-pressable:active {
    transform: scale(0.97);
    opacity: 0.85;
}


/* ============================================
   7. NATIVE SCROLL BEHAVIOR
   ============================================ */

/* Momentum scrolling */
.nexus-scroll {
    overflow-y: auto;
    overscroll-behavior-y: contain;
}

/* Hide scrollbars on mobile but keep functionality */
.nexus-scroll-hidden::-webkit-scrollbar {
    display: none;
}

.nexus-scroll-hidden {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

/* Smooth scroll for anchor links */
html {
    scroll-behavior: smooth;
}

@media (prefers-reduced-motion: reduce) {
    html {
        scroll-behavior: auto;
    }

    .skeleton {
        animation: none;
    }
}


/* ============================================
   8. FLOATING ACTION BUTTON ENHANCEMENTS
   ============================================ */

/* Move FAB above bottom nav on mobile */
@media (max-width: 768px) {

    .home-fab,
    .wallet-fab,
    .groups-fab,
    .profile-fab,
    .messages-fab,
    .dash-fab {
        bottom: calc(80px + env(safe-area-inset-bottom)) !important;
    }
}


/* ============================================
   9. TOAST NOTIFICATIONS
   ============================================ */

.nexus-toast-container {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    z-index: var(--z-dropdown, 1000);
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    pointer-events: none;
}

@media (max-width: 768px) {
    .nexus-toast-container {
        bottom: calc(90px + env(safe-area-inset-bottom));
    }
}

.nexus-toast {
    background: var(--color-slate-900-alpha-95);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    color: white;
    padding: var(--space-3) var(--space-6);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: 500;
    box-shadow: 0 10px 40px var(--color-black-alpha-30);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    animation: toast-in var(--transition-base) var(--ease-out);
    pointer-events: auto;
}

.nexus-toast.success {
    background: var(--color-emerald-alpha-95);
}

.nexus-toast.error {
    background: var(--color-red-alpha-95);
}

.nexus-toast.warning {
    background: var(--color-amber-500-alpha-95);
}

.nexus-toast.exit {
    animation: toast-out var(--transition-fast) ease-out forwards;
}

@keyframes toast-in {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes toast-out {
    from {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    to {
        opacity: 0;
        transform: translateY(-10px) scale(0.9);
    }
}


/* ============================================
   10. LOADING OVERLAY
   ============================================ */

.nexus-loading-overlay {
    position: fixed;
    inset: 0;
    background: var(--color-white-alpha-90);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-fast);
}

[data-theme="dark"] .nexus-loading-overlay {
    background: var(--color-slate-900-alpha-90);
}

.nexus-loading-overlay.visible {
    opacity: 1;
    visibility: visible;
}

.nexus-loading-spinner {
    width: var(--space-12);
    height: var(--space-12);
    border: 4px solid var(--color-indigo-alpha-20);
    border-top-color: var(--color-primary-500);
    border-radius: 50%;
    animation: loading-spin var(--transition-slow) linear infinite;
}

.nexus-loading-text {
    margin-top: var(--space-4);
    color: var(--color-slate-500);
    font-weight: 500;
}

@keyframes loading-spin {
    to {
        transform: rotate(360deg);
    }
}


/* ============================================
   11. NATIVE SHARE SHEET
   ============================================ */

.nexus-share-sheet {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal-backdrop, 1300);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-base) var(--ease-in-out);
}

.nexus-share-sheet.active {
    opacity: 1;
    visibility: visible;
}

.nexus-share-sheet-backdrop {
    position: absolute;
    inset: 0;
    background: var(--color-black-alpha-50);
    -webkit-backdrop-filter: blur(4px);
    backdrop-filter: blur(4px);
}

.nexus-share-sheet-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    transform: translateY(100%);
    transition: transform var(--transition-base) var(--ease-in-out);
    padding-bottom: env(safe-area-inset-bottom);
}

.nexus-share-sheet.active .nexus-share-sheet-content {
    transform: translateY(0);
}

[data-theme="dark"] .nexus-share-sheet-content {
    background: var(--color-slate-800);
}

.nexus-share-sheet-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-4) var(--space-5);
    border-bottom: 1px solid var(--color-black-alpha-10);
}

.nexus-share-sheet-header h3 {
    margin: 0;
    font-size: var(--font-size-lg);
    font-weight: 700;
}

.nexus-share-close {
    width: var(--space-8);
    height: var(--space-8);
    border-radius: 50%;
    background: var(--color-black-alpha-5);
    border: none;
    font-size: var(--font-size-xl);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

[data-theme="dark"] .nexus-share-close {
    background: var(--color-white-alpha-10);
    color: white;
}

.nexus-share-sheet-body {
    padding: var(--space-5);
}

.nexus-share-options {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-4);
}

.nexus-share-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-4) var(--space-2);
    border: none;
    background: var(--color-black-alpha-3);
    border-radius: var(--radius-lg);
    text-decoration: none;
    color: inherit;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.nexus-share-option:active {
    transform: scale(0.95);
    background: var(--color-indigo-alpha-10);
}

.nexus-share-option i {
    font-size: var(--font-size-2xl);
    width: var(--space-12);
    height: var(--space-12);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
    color: white;
}

.nexus-share-option:nth-child(2) i {
    background: #1877f2;
}

.nexus-share-option:nth-child(3) i {
    background: var(--color-black);
}

.nexus-share-option:nth-child(4) i {
    background: #25d366;
}

.nexus-share-option:nth-child(5) i {
    background: linear-gradient(135deg, var(--color-danger), var(--color-orange-500));
}

.nexus-share-option span {
    font-size: var(--font-size-xs);
    font-weight: 600;
    text-align: center;
}

[data-theme="dark"] .nexus-share-option {
    background: var(--color-white-alpha-5);
    color: white;
}


/* ============================================
   12. CAMERA CAPTURE UI
   ============================================ */

.nexus-camera-ui {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal, 1400);
    background: var(--color-black);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-base) var(--ease-in-out);
}

.nexus-camera-ui.active {
    opacity: 1;
    visibility: visible;
}

.nexus-camera-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.nexus-camera-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.nexus-camera-controls {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: var(--space-8) var(--space-10);
    padding-bottom: calc(30px + env(safe-area-inset-bottom));
    background: linear-gradient(transparent, var(--color-black-alpha-70));
}

.nexus-camera-btn {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: none;
    background: var(--color-white-alpha-20);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    color: white;
    font-size: var(--font-size-xl);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
}

.nexus-camera-btn:active {
    transform: scale(0.9);
}

.nexus-camera-capture {
    width: 72px;
    height: 72px;
    background: white;
    color: var(--color-gray-800);
    font-size: var(--font-size-2xl);
    box-shadow: 0 4px 20px var(--color-black-alpha-30);
}

.nexus-camera-capture:active {
    background: var(--color-gray-200);
}

.nexus-camera-preview {
    position: absolute;
    inset: 0;
    background: var(--color-black);
    display: none;
    flex-direction: column;
}

.nexus-camera-preview-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.nexus-camera-preview-actions {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    gap: var(--space-5);
    padding: var(--space-8);
    padding-bottom: calc(30px + env(safe-area-inset-bottom));
    background: linear-gradient(transparent, var(--color-black-alpha-80));
}

.nexus-camera-preview-actions .nexus-camera-btn {
    width: auto;
    padding: var(--space-3) 28px;
    border-radius: var(--radius-md);
    gap: var(--space-2);
    font-size: var(--font-size-base);
    font-weight: 600;
}

.nexus-camera-preview-actions .nexus-camera-btn.primary {
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-purple-500));
}


/* ============================================
   13. TURBO PROGRESS BAR
   ============================================ */

#nexus-turbo-progress {
    position: fixed;
    top: 0;
    left: 0;
    width: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--color-primary-500), var(--color-purple-500), var(--color-pink-500));
    z-index: var(--z-notification, 1700);
    transition: width var(--transition-fast) var(--ease-out);
    box-shadow: 0 0 10px var(--color-indigo-alpha-50);
    pointer-events: none;
}

#nexus-turbo-progress.active {
    animation: turboProgress 2s ease-in-out infinite;
}

@keyframes turboProgress {
    0% {
        width: 0;
    }

    50% {
        width: 70%;
    }

    100% {
        width: 90%;
    }
}


/* ============================================
   14. ENHANCED TAP FEEDBACK
   ============================================ */

.nexus-ripple {
    position: relative;
    overflow: hidden;
}

.nexus-ripple::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: var(--color-white-alpha-30);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    opacity: 0;
}

.nexus-ripple:active::after {
    width: 200%;
    padding-bottom: 200%;
    opacity: 1;
    transition: all var(--transition-slow) var(--ease-out);
}


/* ============================================
   INFINITE SCROLL
   ============================================ */

.nexus-infinite-loader {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    padding: var(--space-6);
    color: var(--color-slate-500);
    font-size: var(--font-size-sm);
}

[data-theme="dark"] .nexus-infinite-loader {
    color: var(--color-slate-400);
}

.nexus-infinite-spinner {
    width: var(--space-6);
    height: var(--space-6);
    border: 3px solid var(--color-indigo-alpha-20);
    border-top-color: var(--color-primary-500);
    border-radius: 50%;
    animation: infinite-spin var(--transition-slow) linear infinite;
}

@keyframes infinite-spin {
    to {
        transform: rotate(360deg);
    }
}

.nexus-infinite-end {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-8) var(--space-6);
    color: var(--color-slate-400);
    font-size: var(--font-size-sm);
    text-align: center;
}

[data-theme="dark"] .nexus-infinite-end {
    color: var(--color-slate-500);
}

.nexus-infinite-end::before,
.nexus-infinite-end::after {
    content: '';
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--color-slate-400-alpha-30), transparent);
    margin: 0 var(--space-4);
}


/* ============================================
   LONG-PRESS CONTEXT MENU
   ============================================ */

.nexus-context-backdrop {
    position: fixed;
    inset: 0;
    background: var(--color-black-alpha-40);
    opacity: 0;
    visibility: hidden;
    z-index: 99998;
    transition: opacity var(--transition-fast) var(--ease-in-out), visibility var(--transition-fast) var(--ease-in-out);
    -webkit-backdrop-filter: blur(2px);
    backdrop-filter: blur(2px);
}

.nexus-context-backdrop.visible {
    opacity: 1;
    visibility: visible;
}

.nexus-context-menu {
    position: fixed;
    min-width: 200px;
    max-width: 280px;
    background: white;
    border-radius: var(--radius-md);
    box-shadow:
        0 10px 40px var(--color-black-alpha-20),
        0 0 0 1px var(--color-black-alpha-5);
    z-index: var(--z-notification, 1700);
    opacity: 0;
    visibility: hidden;
    transform: scale(0.9);
    transform-origin: center center;
    transition: opacity var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) cubic-bezier(0.34, 1.56, 0.64, 1), visibility var(--transition-fast) var(--ease-in-out);
    overflow: hidden;
}

[data-theme="dark"] .nexus-context-menu {
    background: var(--color-slate-800);
    box-shadow:
        0 10px 40px var(--color-black-alpha-40),
        0 0 0 1px var(--color-white-alpha-10);
}

.nexus-context-menu.visible {
    opacity: 1;
    visibility: visible;
    transform: scale(1);
}

.nexus-context-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    width: 100%;
    padding: var(--space-3) var(--space-4);
    border: none;
    background: transparent;
    color: var(--color-slate-800);
    font-size: var(--font-size-base);
    font-weight: 500;
    text-align: left;
    cursor: pointer;
    transition: background var(--transition-fast) var(--ease-in-out);
}

[data-theme="dark"] .nexus-context-item {
    color: var(--color-slate-100);
}

.nexus-context-item:not(:last-child) {
    border-bottom: 1px solid var(--color-black-alpha-6);
}

[data-theme="dark"] .nexus-context-item:not(:last-child) {
    border-bottom-color: var(--color-white-alpha-6);
}

.nexus-context-item:active {
    background: var(--color-indigo-alpha-10);
}

[data-theme="dark"] .nexus-context-item:active {
    background: var(--color-indigo-alpha-20);
}

.nexus-context-item i {
    width: var(--space-5);
    text-align: center;
    color: var(--color-primary-500);
    font-size: var(--font-size-base);
}

[data-theme="dark"] .nexus-context-item i {
    color: var(--color-primary-400);
}

.nexus-context-item.danger {
    color: var(--color-danger);
}

.nexus-context-item.danger i {
    color: var(--color-danger);
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .nexus-context-menu {
        transition: opacity var(--transition-fast) var(--ease-in-out), visibility var(--transition-fast) var(--ease-in-out);
        transform: scale(1);
    }

    .nexus-context-backdrop {
        transition: opacity var(--transition-fast) var(--ease-in-out), visibility var(--transition-fast) var(--ease-in-out);
    }

    .nexus-infinite-spinner {
        animation-duration: 1.5s;
    }
}

/* Material-style ripple for buttons */
.htb-btn,
.nexus-bottom-nav-item,
.nexus-fab-item,
.nexus-share-option {
    position: relative;
    overflow: hidden;
}

@media (hover: none) and (pointer: coarse) {

    .htb-btn:active,
    .nexus-bottom-nav-item:active {
        transform: scale(0.97);
    }
}


/* ============================================
   15. OFFLINE/ONLINE INDICATORS
   ============================================ */

.nexus-offline-indicator {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, var(--color-warning) 0%, var(--color-amber-600) 100%);
    color: white;
    text-align: center;
    padding: var(--space-3) var(--space-4);
    font-size: 13px;
    font-weight: 600;
    z-index: var(--z-popover, 1500);
    transform: translateY(-100%);
    transition: transform var(--transition-base) cubic-bezier(0.68, -0.55, 0.265, 1.55);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding-top: max(var(--space-3), env(safe-area-inset-top));
}

.nexus-offline-indicator.visible {
    transform: translateY(0);
}

.nexus-offline-indicator svg {
    width: var(--space-4);
    height: var(--space-4);
    flex-shrink: 0;
}

/* Adjust content when offline banner is visible */
body.is-offline .nexus-utility-bar,
body.is-offline .htb-header,
body.is-offline header {
    margin-top: var(--space-10);
}

.nexus-online-indicator {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, var(--color-success) 0%, var(--color-green-600) 100%);
    color: white;
    text-align: center;
    padding: var(--space-3) var(--space-4);
    font-size: 13px;
    font-weight: 600;
    z-index: var(--z-popover, 1500);
    transform: translateY(-100%);
    transition: transform var(--transition-base) cubic-bezier(0.68, -0.55, 0.265, 1.55);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding-top: max(var(--space-3), env(safe-area-inset-top));
}

.nexus-online-indicator.visible {
    transform: translateY(0);
}

.nexus-online-indicator svg {
    width: var(--space-4);
    height: var(--space-4);
    flex-shrink: 0;
}

@media (prefers-reduced-motion: reduce) {

    .nexus-offline-indicator,
    .nexus-online-indicator {
        transition: none;
    }
}


/* ============================================
   16. COLLAPSING HEADER ON SCROLL
   ============================================ */

/* Base collapsing header styles */
.nexus-collapsing-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    transition: transform var(--transition-base) var(--ease-in-out),
        height var(--transition-base) var(--ease-in-out),
        padding var(--transition-base) var(--ease-in-out),
        box-shadow var(--transition-base) var(--ease-in-out);
    will-change: transform;
}

/* Hidden state - slides up */
.nexus-collapsing-header.nexus-header-hidden {
    transform: translateY(-100%);
    pointer-events: none;
}

/* Visible state after being hidden - smooth slide down */
.nexus-collapsing-header.nexus-header-visible {
    transform: translateY(0);
    pointer-events: auto;
    box-shadow: 0 2px 20px var(--color-black-alpha-10);
}

[data-theme="dark"] .nexus-collapsing-header.nexus-header-visible {
    box-shadow: 0 2px 20px var(--color-black-alpha-30);
}

/* Compact mode - smaller, more minimal */
.nexus-collapsing-header.nexus-header-compact {
    padding-top: var(--space-2);
    padding-bottom: var(--space-2);
}

/* Compact mode for common header elements */
.nexus-collapsing-header.nexus-header-compact .htb-header-title,
.nexus-collapsing-header.nexus-header-compact .header-title,
.nexus-collapsing-header.nexus-header-compact h1 {
    font-size: var(--font-size-lg);
    margin: 0 !important;
}

.nexus-collapsing-header.nexus-header-compact .htb-header-subtitle,
.nexus-collapsing-header.nexus-header-compact .header-subtitle {
    display: none !important;
}

/* Hide secondary elements in compact mode */
.nexus-collapsing-header.nexus-header-compact .header-description,
.nexus-collapsing-header.nexus-header-compact .header-meta,
.nexus-collapsing-header.nexus-header-compact .htb-breadcrumb {
    display: none !important;
}

/* Shrink avatars/logos in compact mode */
.nexus-collapsing-header.nexus-header-compact .header-avatar,
.nexus-collapsing-header.nexus-header-compact .header-logo,
.nexus-collapsing-header.nexus-header-compact .htb-avatar {
    width: 32px !important;
    height: 32px !important;
    transition: all var(--transition-base) var(--ease-in-out);
}

/* Reduce button sizes in compact mode */
.nexus-collapsing-header.nexus-header-compact .htb-btn {
    padding: var(--space-1) var(--space-3) !important;
    font-size: var(--font-size-sm);
}

/* Add shadow in compact mode for visual separation */
.nexus-collapsing-header.nexus-header-compact {
    box-shadow: 0 2px 12px var(--color-black-alpha-8);
}

[data-theme="dark"] .nexus-collapsing-header.nexus-header-compact {
    box-shadow: 0 2px 12px var(--color-black-alpha-25);
}

/* Body adjustments when header is hidden */
body.nexus-header-is-hidden {
    /* Content can flow naturally when header is hidden */
}

/* Body adjustments when header is compact */
body.nexus-header-is-compact {
    /* Content area gains more space */
}

/* Mobile-specific optimizations */
@media (max-width: 768px) {
    .nexus-collapsing-header {
        /* Faster transitions on mobile for snappier feel */
        transition: transform var(--transition-base) var(--ease-in-out),
            height var(--transition-base) var(--ease-in-out),
            padding var(--transition-base) var(--ease-in-out),
            box-shadow var(--transition-base) var(--ease-in-out);
    }

    .nexus-collapsing-header.nexus-header-compact {
        padding-top: 6px !important;
        padding-bottom: 6px !important;
    }

    .nexus-collapsing-header.nexus-header-compact .htb-header-title,
    .nexus-collapsing-header.nexus-header-compact h1 {
        font-size: var(--font-size-base);
    }

    /* Reduce icon sizes in compact mode on mobile */
    .nexus-collapsing-header.nexus-header-compact .htb-btn i,
    .nexus-collapsing-header.nexus-header-compact .header-icon {
        font-size: var(--font-size-base);
    }
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    .nexus-collapsing-header {
        transition: none;
    }

    .nexus-collapsing-header.nexus-header-hidden {
        opacity: 0;
        transform: none;
    }

    .nexus-collapsing-header.nexus-header-visible {
        opacity: 1;
        transform: none;
    }

    .nexus-collapsing-header.nexus-header-compact .header-avatar,
    .nexus-collapsing-header.nexus-header-compact .header-logo,
    .nexus-collapsing-header.nexus-header-compact .htb-avatar {
        transition: none;
    }
}

/* Utility class - add to any header to enable collapsing */
[data-collapsing-header="true"] {
    /* Marker for JS initialization */
}

/* ============================================
   MOBILE SUB-PAGE TOP SPACING FIX
   Uniform spacing across all about sub-pages
   ============================================ */
@media (max-width: 900px) {

    /* All glass wrappers - consistent top spacing (56px clears mobile header) */
    #strategy-glass-wrapper,
    #faq-glass-wrapper,
    #sp-glass-wrapper,
    #guide-glass-wrapper,
    #story-glass-wrapper,
    #partner-glass-wrapper,
    #impact-glass-wrapper,
    #report-glass-wrapper,
    #privacy-glass-wrapper,
    #terms-glass-wrapper,
    [id$="-glass-wrapper"],
    [id*="glass-wrapper"] {
        margin-top: var(--layout-header-height) !important;
        padding-top: var(--space-4);
    }

    /* Container full - uniform spacing */
    .htb-container-full {
        padding-top: var(--space-4);
        margin-top: var(--layout-header-height) !important;
    }

    /* Welcome hero sections - uniform top margin */
    .nexus-welcome-hero {
        margin-top: 0 !important;
    }

    /* Inner wrappers - no extra padding */
    .faq-inner,
    .sp-inner,
    .impact-inner,
    [class$="-inner"] {
        padding-top: 0 !important;
    }

    /* Page headers - consistent spacing */
    .page-header,
    .faq-page-header,
    .sp-page-header,
    .strategy-page-header,
    [class$="-page-header"],
    [id$="-glass-wrapper"] .page-header,
    .htb-container .page-header,
    .htb-container-full .page-header {
        margin-top: 0 !important;
        margin-bottom: var(--space-4);
        padding-top: 0 !important;
    }

    /* Compact hero sections on mobile sub-pages */
    .htb-hero-header {
        height: auto !important;
        min-height: 120px !important;
        padding: var(--space-5) var(--space-4) !important;
    }

    .htb-hero-content {
        padding: var(--space-3) var(--space-4) !important;
    }

    .htb-main-title {
        font-size: var(--font-size-3xl);
    }

    .htb-sub-title {
        font-size: var(--font-size-base);
    }

    /* Cards that pull up into hero area */
    .htb-container[style*="margin-top: -80px"],
    .htb-container-full[style*="margin-top: -80px"] {
        margin-top: var(--space-4);
    }

    /* Generic first-child content spacing */
    .htb-container>*:first-child,
    .htb-container-full>*:first-child {
        margin-top: 0;
    }
}

/* === nexus-native-nav-v2.css === */
/**
 * Project NEXUS - Native Mobile Navigation v2
 * Full-screen, app-like navigation inspired by Instagram, TikTok, and iOS
 * Designed for a true native mobile experience
  * Fully Migrated to Design Tokens: 2026-01-21 ✓
 */

/* ============================================
   CRITICAL: Hide mobile navigation on desktop
   ============================================ */
@media (min-width: 1025px) {
    .mobile-fullscreen-menu,
    .mobile-notification-sheet,
    .mobile-tab-bar,
    #mobileMenu,
    #mobileNotifications {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }
}

/* ============================================
   CSS VARIABLES - Design Tokens
   ============================================ */
:root {
    /* Navigation Colors */
    --mobile-nav-bg: var(--color-white);
    --mobile-nav-border: var(--color-black-alpha-8);
    --mobile-nav-text: #8e8e93;
    --mobile-nav-active: var(--color-primary-500);
    --mobile-nav-height: 84px;

    /* Menu Colors */
    --mobile-menu-bg: var(--color-white);
    --mobile-menu-item-hover: var(--color-slate-50);
    --mobile-menu-divider: var(--color-slate-100);
    --mobile-menu-text: var(--color-slate-800);
    --mobile-menu-text-secondary: var(--color-slate-500);

    /* Safe Areas */
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --safe-top: env(safe-area-inset-top, 0px);

    /* Transitions */
    --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
    --ease-smooth: var(--ease-in-out);
    --ease-ios: cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

[data-theme="dark"] {
    --mobile-nav-bg: var(--color-black);
    --mobile-nav-border: var(--color-white-alpha-10);
    --mobile-nav-text: #8e8e93;
    --mobile-nav-active: var(--color-primary-400);

    --mobile-menu-bg: var(--color-black);
    --mobile-menu-item-hover: #1c1c1e;
    --mobile-menu-divider: #38383a;
    --mobile-menu-text: var(--color-white);
    --mobile-menu-text-secondary: #8e8e93;
}


/* ============================================
   HIDE ALL LEGACY NAVIGATION ON MOBILE
   ============================================ */
@media (max-width: 1024px) {

    /* Hide old bottom nav systems (but keep drawer for fallback) */
    .nexus-bottom-nav,
    .nexus-native-nav,
    .nexus-quick-fab,
    .nexus-edge-indicator,
    .app-drawer {
        display: none !important;
        visibility: hidden !important;
        pointer-events: none !important;
    }

    /* Note: nexus-native-drawer and overlay are NOT hidden - they serve as fallback
       when openMobileMenu() is not yet defined (function loading order issue) */
}


/* ============================================
   1. BOTTOM TAB BAR - Modern iOS/Android Style
   Clean, minimal, perfect alignment
   ============================================ */

.mobile-tab-bar {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: var(--z-fixed, 1200);
    height: var(--mobile-nav-height, 60px);
    padding-bottom: var(--safe-bottom, env(safe-area-inset-bottom, 0px));
    background: var(--color-white-alpha-95);
    border-top: 1px solid var(--color-black-alpha-6);
    -webkit-backdrop-filter: saturate(180%) blur(20px);
    backdrop-filter: saturate(180%) blur(20px);
}

[data-theme="dark"] .mobile-tab-bar,
.dark-mode .mobile-tab-bar {
    background: var(--color-zinc-900-alpha-95);
    border-top-color: var(--color-white-alpha-8);
}

@media (max-width: 1024px) {
    /* CRITICAL: Force show mobile tab bar */
    .mobile-tab-bar,
    #mobileTabBar {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        z-index: var(--z-notification, 1700);
        height: var(--mobile-nav-height, 84px) !important;
        background: var(--color-white-alpha-95) !important;
        -webkit-backdrop-filter: saturate(180%) blur(20px) !important;
        backdrop-filter: saturate(180%) blur(20px) !important;
        border-top: 1px solid var(--color-black-alpha-10) !important;
    }

    [data-theme="dark"] .mobile-tab-bar,
    [data-theme="dark"] #mobileTabBar {
        background: var(--color-zinc-900-alpha-95) !important;
        border-top-color: var(--color-white-alpha-10) !important;
    }

    body {
        padding-bottom: calc(var(--mobile-nav-height, 84px) + var(--safe-bottom, env(safe-area-inset-bottom, 0px))) !important;
    }
}

.mobile-tab-bar-inner {
    display: flex;
    justify-content: space-around;
    align-items: center;
    height: 100%;
    max-width: 500px;
    margin: 0 auto;
    width: 100%;
    padding: 0 var(--space-2);
}

/* Tab Items - Clean, minimal design */
.mobile-tab-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-1);
    flex: 1;
    min-width: 64px;
    max-width: 80px;
    height: 100%;
    text-decoration: none;
    color: var(--color-gray-500); /* Darker gray for WCAG AA contrast (4.59:1 on white) */
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    letter-spacing: 0;
    position: relative;
    -webkit-tap-highlight-color: transparent;
    transition: color var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) var(--ease-in-out);
    background: none;
    border: none;
    cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', sans-serif;
    padding: var(--space-2) 0;
}

/* Button-type tab items - explicit reset for menu button */
button.mobile-tab-item,
.mobile-tab-item[type="button"] {
    background: none;
    border: none;
    outline: none;
    -webkit-appearance: none;
    appearance: none;
    margin: 0;
}

.mobile-tab-item:active {
    transform: scale(0.9);
}

.mobile-tab-item i {
    font-size: var(--font-size-xl);
    line-height: 1;
    transition: transform var(--transition-fast) var(--ease-in-out);
}

.mobile-tab-item.active {
    color: var(--color-primary-500);
}

.mobile-tab-item.active i {
    transform: scale(1.08);
}

[data-theme="dark"] .mobile-tab-item,
.dark-mode .mobile-tab-item {
    color: var(--color-gray-400); /* Lighter gray for WCAG AA on dark background (4.85:1 on #1c1c1e) */
}

[data-theme="dark"] .mobile-tab-item.active,
.dark-mode .mobile-tab-item.active {
    color: var(--color-primary-400);
}

/* Notification Badge */
.mobile-tab-badge {
    position: absolute;
    top: var(--space-1);
    left: 50%;
    transform: translateX(var(--space-2));
    min-width: calc(var(--space-4) + var(--space-1));
    height: calc(var(--space-4) + var(--space-1));
    background: #ff3b30;
    color: white;
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    border-radius: var(--radius-base);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 var(--space-1);
    box-shadow: 0 2px 6px var(--color-red-alpha-40);
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    z-index: 10;
}

.mobile-tab-badge:empty {
    display: none;
}

/* ============================================
   CENTER CREATE BUTTON - Floating FAB Style
   ============================================ */

.mobile-tab-item.create-btn {
    position: relative;
    flex: 0 0 auto;
    width: calc(var(--space-12) + var(--space-2));
    min-width: calc(var(--space-12) + var(--space-2));
    max-width: calc(var(--space-12) + var(--space-2));
}

.mobile-tab-item.create-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: var(--space-12);
    height: var(--space-12);
    background: linear-gradient(135deg, var(--color-primary-500) 0%, var(--color-purple-500) 100%);
    border-radius: var(--radius-lg);
    z-index: 1;
    box-shadow:
        0 4px 14px var(--color-indigo-alpha-40),
        0 2px 6px var(--color-indigo-alpha-20);
    transition: transform var(--transition-fast) var(--ease-in-out), box-shadow var(--transition-fast) var(--ease-in-out);
}

.mobile-tab-item.create-btn:hover::before {
    transform: translate(-50%, -50%) scale(1.05);
    box-shadow:
        0 6px 20px var(--color-indigo-alpha-50),
        0 3px 8px var(--color-indigo-alpha-30);
}

.mobile-tab-item.create-btn:active::before {
    transform: translate(-50%, -50%) scale(0.92);
    box-shadow:
        0 2px 8px var(--color-indigo-alpha-30),
        0 1px 4px var(--color-indigo-alpha-20);
}

.mobile-tab-item.create-btn:active {
    transform: none;
}

.mobile-tab-item.create-btn>i,
.mobile-tab-item.create-btn>svg.create-icon {
    color: white !important;
    fill: white !important;
    width: var(--space-6);
    height: var(--space-6);
    font-size: var(--font-size-xl);
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
    filter: drop-shadow(0 1px 2px var(--color-black-alpha-15));
}

.mobile-tab-item.create-btn>span {
    display: none;
}

/* Profile Avatar Tab */
.mobile-tab-avatar {
    width: calc(var(--space-6) + var(--space-1));
    height: calc(var(--space-6) + var(--space-1));
    border-radius: var(--radius-full);
    object-fit: cover;
    border: 2px solid transparent;
    transition: border-color var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) var(--ease-in-out);
}

.mobile-tab-item.active .mobile-tab-avatar {
    border-color: var(--mobile-nav-active);
    transform: scale(1.05);
}


/* ============================================
   2. FULL-SCREEN MENU - Instagram/TikTok Style
   ============================================ */

.mobile-fullscreen-menu {
    position: fixed;
    inset: 0;
    z-index: var(--z-notification, 1700);
    background: var(--mobile-menu-bg);
    transform: translateX(100%);
    transition: transform 0.35s var(--ease-ios);
    display: flex;
    flex-direction: column;
    visibility: hidden;
    will-change: transform;
    /* Ensure menu itself can contain scrollable content */
    height: 100%;
    height: 100dvh; /* Dynamic viewport height for mobile */
    overflow: hidden; /* Menu container doesn't scroll, only menu-body does */
}

.mobile-fullscreen-menu.active {
    transform: translateX(0);
    visibility: visible;
}

/* Prevent body scroll when menu is open - MOBILE ONLY */
@media (max-width: 1024px) {
    body.mobile-menu-open {
        overflow: hidden;
        /* NOTE: position: fixed breaks iOS scroll inside the menu panel.
           Using overflow: hidden alone is sufficient to prevent body scroll. */
        touch-action: none; /* Prevent touch scroll on body */
    }
}

/* Menu Header - Enhanced Full-Screen Design */
.mobile-menu-header {
    padding: var(--space-5) var(--space-5) var(--space-6);
    padding-top: calc(var(--space-5) + var(--safe-top));
    background: var(--mobile-menu-bg);
    border-bottom: 0.5px solid var(--mobile-menu-divider);
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    overflow: hidden;
    min-height: 100px;
}

/* Animated gradient background */
.mobile-menu-header-bg {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg,
        var(--color-indigo-alpha-8) 0%,
        var(--color-violet-alpha-8) 50%,
        var(--color-indigo-alpha-8) 100%);
    background-size: 200% 200%;
    animation: gradient-shift 8s ease infinite;
    z-index: 0;
    pointer-events: none;
}

@keyframes gradient-shift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

[data-theme="dark"] .mobile-menu-header-bg {
    background: linear-gradient(135deg,
        var(--color-indigo-alpha-12) 0%,
        var(--color-violet-alpha-12) 50%,
        var(--color-indigo-alpha-12) 100%);
    background-size: 200% 200%;
}

.mobile-menu-user {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    text-decoration: none;
    color: var(--mobile-menu-text);
    position: relative;
    z-index: 1;
    transition: transform var(--transition-fast) var(--ease-in-out);
    -webkit-tap-highlight-color: transparent;
}

.mobile-menu-user:active {
    transform: scale(0.98);
}

/* Avatar wrapper with animated ring */
.mobile-menu-avatar-wrapper {
    position: relative;
    width: var(--space-16);
    height: var(--space-16);
    flex-shrink: 0;
}

.mobile-menu-avatar {
    width: var(--space-16);
    height: var(--space-16);
    border-radius: var(--radius-full);
    object-fit: cover;
    border: 3px solid var(--mobile-menu-bg);
    box-shadow: 0 4px 12px var(--color-black-alpha-10);
    position: relative;
    z-index: 2;
}

/* Animated pulsing ring around avatar */
.mobile-menu-avatar-ring {
    position: absolute;
    inset: -4px;
    border-radius: var(--radius-full);
    border: 2px solid var(--color-indigo-alpha-40);
    z-index: 1;
    animation: avatar-ring-pulse 3s ease-in-out infinite;
}

@keyframes avatar-ring-pulse {
    0%, 100% {
        transform: scale(1);
        opacity: 0.4;
    }
    50% {
        transform: scale(1.08);
        opacity: 0.6;
    }
}

[data-theme="dark"] .mobile-menu-avatar {
    border-color: #1c1c1e;
    box-shadow: 0 4px 12px var(--color-black-alpha-30);
}

[data-theme="dark"] .mobile-menu-avatar-ring {
    border-color: var(--color-indigo-300-alpha-50);
}

/* Guest avatar styling */
.mobile-menu-avatar-guest {
    width: var(--space-16);
    height: var(--space-16);
    border-radius: var(--radius-full);
    background: linear-gradient(135deg, var(--color-primary-500) 0%, var(--color-purple-500) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: calc(var(--font-size-2xl) + 0.25rem);
    box-shadow: 0 4px 12px var(--color-indigo-alpha-30);
}

.mobile-menu-user-info {
    flex: 1;
    min-width: 0;
}

.mobile-menu-user-info h3 {
    margin: 0 0 var(--space-1) 0;
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    letter-spacing: -0.03em;
    color: var(--mobile-menu-text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.mobile-menu-user-info p {
    margin: 0;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--mobile-nav-active);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.mobile-menu-user-info p i {
    font-size: var(--font-size-xs);
    transition: transform var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-user:active .mobile-menu-user-info p i {
    transform: translateX(var(--space-1));
}

/* Close Button - Enhanced Design */
.mobile-menu-close {
    width: calc(var(--space-10) + var(--space-1));
    height: calc(var(--space-10) + var(--space-1));
    border-radius: var(--radius-full);
    background: var(--color-black-alpha-5);
    border: none;
    color: var(--mobile-menu-text);
    font-size: var(--font-size-xl);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    -webkit-tap-highlight-color: transparent;
    transition: transform var(--transition-fast) var(--ease-in-out), background var(--transition-fast) var(--ease-in-out);
    position: relative;
    z-index: 1;
    flex-shrink: 0;
}

.mobile-menu-close:hover {
    background: var(--color-black-alpha-8);
}

.mobile-menu-close:active {
    transform: scale(0.88);
    background: var(--color-black-alpha-12);
}

[data-theme="dark"] .mobile-menu-close {
    background: var(--color-white-alpha-8);
}

[data-theme="dark"] .mobile-menu-close:hover {
    background: var(--color-white-alpha-12);
}

[data-theme="dark"] .mobile-menu-close:active {
    background: var(--color-white-alpha-18);
}

/* Menu Body - Scrollable */
.mobile-menu-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    overscroll-behavior-y: contain;
    -webkit-overflow-scrolling: touch;
    /* CRITICAL: Allow touch scrolling inside the menu (body has touch-action: none) */
    touch-action: pan-y;
    /* Minimum height to ensure flex child fills space */
    min-height: 0; /* Required for flex children to scroll properly */
}

/* Menu Sections */
.mobile-menu-section {
    padding: var(--space-3) 0;
    border-bottom: 0.5px solid var(--mobile-menu-divider);
}

.mobile-menu-section:last-child {
    border-bottom: none;
}

.mobile-menu-section-title {
    padding: var(--space-2) var(--space-5) var(--space-3);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--mobile-menu-text-secondary);
}

/* Menu Items - Large, clear, accessible with gradient icons */
.mobile-menu-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) var(--space-5);
    text-decoration: none;
    color: var(--mobile-menu-text);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    letter-spacing: -0.01em;
    -webkit-tap-highlight-color: transparent;
    transition: background var(--transition-fast) var(--ease-in-out), transform var(--transition-fast) var(--ease-in-out);
    position: relative;
}

.mobile-menu-item:active {
    background: var(--mobile-menu-item-hover);
    transform: scale(0.98);
}

/* Icon container with gradient background */
.mobile-menu-item i {
    width: var(--space-10);
    height: var(--space-10);
    min-width: var(--space-10);
    border-radius: var(--radius-md);
    font-size: var(--font-size-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    background: linear-gradient(135deg, var(--color-primary-500) 0%, var(--color-purple-500) 100%);
    transition: transform var(--transition-fast) var(--ease-in-out), box-shadow var(--transition-fast) var(--ease-in-out);
    box-shadow: 0 2px 8px var(--color-indigo-alpha-25);
}

.mobile-menu-item:active i {
    transform: scale(0.92);
    box-shadow: 0 1px 4px var(--color-indigo-alpha-20);
}

/* Different gradient colors for menu items based on position */
.mobile-menu-item:nth-child(1) i { background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-red-400) 100%); box-shadow: 0 2px 8px var(--color-red-alpha-25); }
.mobile-menu-item:nth-child(2) i { background: linear-gradient(135deg, var(--color-info) 0%, var(--color-blue-400) 100%); box-shadow: 0 2px 8px var(--color-blue-alpha-30); }
.mobile-menu-item:nth-child(3) i { background: linear-gradient(135deg, var(--color-purple-500) 0%, var(--color-purple-400-alt) 100%); box-shadow: 0 2px 8px var(--color-violet-alpha-25); }
.mobile-menu-item:nth-child(4) i { background: linear-gradient(135deg, var(--color-teal-500) 0%, var(--color-teal-400) 100%); box-shadow: 0 2px 8px var(--color-teal-500-alpha-25); }
.mobile-menu-item:nth-child(5) i { background: linear-gradient(135deg, var(--color-warning) 0%, var(--color-amber-300) 100%); box-shadow: 0 2px 8px var(--color-amber-500-alpha-30); }
.mobile-menu-item:nth-child(6) i { background: linear-gradient(135deg, var(--color-success) 0%, var(--color-emerald-400) 100%); box-shadow: 0 2px 8px var(--color-emerald-alpha-25); }
.mobile-menu-item:nth-child(7) i { background: linear-gradient(135deg, var(--color-pink-500) 0%, var(--color-pink-400) 100%); box-shadow: 0 2px 8px var(--color-pink-alpha-25); }
.mobile-menu-item:nth-child(8) i { background: linear-gradient(135deg, var(--color-cyan-500) 0%, var(--color-cyan-400) 100%); box-shadow: 0 2px 8px var(--color-cyan-alpha-25); }

/* Dark mode icon adjustments */
[data-theme="dark"] .mobile-menu-item i {
    box-shadow: 0 2px 8px var(--color-black-alpha-30);
}

/* Admin section special styling */
.mobile-menu-section-title[style*="color: var(--color-orange-600)"] ~ .mobile-menu-item i {
    background: linear-gradient(135deg, var(--color-orange-600) 0%, var(--color-orange-500) 100%) !important;
    box-shadow: 0 2px 8px var(--color-orange-alpha-30) !important;
}

.mobile-menu-section-title[style*="color: var(--color-orange-600)"] {
    font-weight: var(--font-weight-bold);
}

.mobile-menu-item-badge {
    margin-left: auto;
    min-width: calc(var(--space-5) + var(--space-1));
    height: calc(var(--space-5) + var(--space-1));
    background: #ff3b30;
    color: white;
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    border-radius: calc(var(--space-3) - var(--space-1));
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 calc(var(--space-2) - var(--space-1));
}

.mobile-menu-item-arrow {
    margin-left: auto;
    color: var(--mobile-menu-text-secondary);
    font-size: var(--font-size-sm);
    opacity: 0.5;
}

/* Quick Stats Row - Enhanced with gradients */
.mobile-menu-stats {
    display: flex;
    gap: var(--space-3);
    padding: var(--space-4) var(--space-4);
    margin: var(--space-4) var(--space-4);
}

.mobile-menu-stat {
    flex: 1;
    text-align: center;
    padding: var(--space-3) var(--space-3);
    text-decoration: none;
    color: var(--mobile-menu-text);
    position: relative;
    background: linear-gradient(135deg, var(--color-indigo-alpha-8) 0%, var(--color-violet-alpha-8) 100%);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-indigo-alpha-15);
    transition: transform var(--transition-fast) var(--ease-in-out), background var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-stat:active {
    transform: scale(0.96);
}

.mobile-menu-stat:nth-child(1) {
    background: linear-gradient(135deg, var(--color-emerald-alpha-8) 0%, var(--color-emerald-300-alpha-8) 100%);
    border-color: var(--color-emerald-alpha-15);
}

.mobile-menu-stat:nth-child(2) {
    background: linear-gradient(135deg, var(--color-blue-alpha-8) 0%, var(--color-blue-400-alpha-8) 100%);
    border-color: var(--color-blue-alpha-15);
}

.mobile-menu-stat:nth-child(3) {
    background: linear-gradient(135deg, var(--color-red-alpha-10) 0%, var(--color-red-400-alpha-10) 100%);
    border-color: var(--color-red-alpha-15);
}

[data-theme="dark"] .mobile-menu-stat {
    background: linear-gradient(135deg, var(--color-indigo-alpha-12) 0%, var(--color-violet-alpha-12) 100%);
    border-color: var(--color-indigo-alpha-20);
}

[data-theme="dark"] .mobile-menu-stat:nth-child(1) {
    background: linear-gradient(135deg, var(--color-emerald-alpha-12) 0%, var(--color-emerald-300-alpha-12) 100%);
    border-color: var(--color-emerald-alpha-20);
}

[data-theme="dark"] .mobile-menu-stat:nth-child(2) {
    background: linear-gradient(135deg, var(--color-blue-alpha-12) 0%, var(--color-blue-400-alpha-12) 100%);
    border-color: var(--color-blue-alpha-20);
}

[data-theme="dark"] .mobile-menu-stat:nth-child(3) {
    background: linear-gradient(135deg, var(--color-red-alpha-12) 0%, var(--color-red-400-alpha-12) 100%);
    border-color: var(--color-red-alpha-20);
}

.mobile-menu-stat-value {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    background: linear-gradient(135deg, var(--color-primary-500) 0%, var(--color-purple-500) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.2;
}

.mobile-menu-stat:nth-child(1) .mobile-menu-stat-value {
    background: linear-gradient(135deg, var(--color-success) 0%, var(--color-emerald-400) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.mobile-menu-stat:nth-child(2) .mobile-menu-stat-value {
    background: linear-gradient(135deg, var(--color-info) 0%, var(--color-blue-400) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.mobile-menu-stat:nth-child(3) .mobile-menu-stat-value {
    background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-red-400) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.mobile-menu-stat-label {
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    color: var(--mobile-menu-text-secondary);
    margin-top: var(--space-1);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Menu Footer */
.mobile-menu-footer {
    padding: var(--space-4) var(--space-5);
    padding-bottom: calc(var(--space-4) + var(--safe-bottom));
    border-top: 0.5px solid var(--mobile-menu-divider);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.mobile-menu-footer-btn {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    background: var(--mobile-menu-item-hover);
    border: none;
    border-radius: var(--radius-md);
    color: var(--mobile-menu-text);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    transition: transform var(--transition-fast) var(--ease-in-out), background var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-footer-btn:active {
    transform: scale(0.95);
}

.mobile-menu-footer-btn.danger {
    color: #ff3b30;
}

.mobile-menu-footer-btn.danger:active {
    background: var(--color-red-alpha-10);
}


/* ============================================
   3. NOTIFICATION SHEET - Better Bell Display
   ============================================ */

.mobile-notification-sheet {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal-backdrop, 1300);
    visibility: hidden;
    pointer-events: none;
}

.mobile-notification-sheet.active {
    visibility: visible;
    pointer-events: auto;
}

/* Hide bottom nav when notification sheet is active */
@media (max-width: 1024px) {
    body.mobile-notifications-open .mobile-tab-bar,
    body.mobile-notifications-open #mobileTabBar {
        transform: translateY(100%) !important;
        opacity: 0 !important;
        pointer-events: none !important;
        transition: transform var(--transition-base) var(--ease-in-out), opacity var(--transition-base) ease !important;
    }
}

.mobile-notification-backdrop {
    position: absolute;
    inset: 0;
    background: var(--color-black-alpha-40);
    opacity: 0;
    transition: opacity var(--transition-base) var(--ease-in-out);
    -webkit-tap-highlight-color: transparent;
}

.mobile-notification-sheet.active .mobile-notification-backdrop {
    opacity: 1;
}

.mobile-notification-container {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    max-height: 85vh;
    background: var(--mobile-menu-bg);
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    transform: translateY(100%);
    transition: transform var(--transition-slow) var(--ease-ios);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding-bottom: var(--safe-bottom);
}

.mobile-notification-sheet.active .mobile-notification-container {
    transform: translateY(0);
}

/* Sheet Handle */
.mobile-notification-handle {
    display: flex;
    justify-content: center;
    padding: var(--space-3) 0 var(--space-2);
}

.mobile-notification-handle::after {
    content: '';
    width: calc(var(--space-8) + var(--space-1));
    height: var(--space-1);
    background: var(--mobile-menu-divider);
    border-radius: var(--radius-sm);
}

/* Notification Header */
.mobile-notification-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-2) var(--space-5) var(--space-4);
    border-bottom: 0.5px solid var(--mobile-menu-divider);
}

.mobile-notification-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    margin: 0;
    color: var(--mobile-menu-text);
}

.mobile-notification-actions {
    display: flex;
    gap: var(--space-3);
}

.mobile-notification-action {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--mobile-nav-active);
    background: none;
    border: none;
    cursor: pointer;
    padding: var(--space-2);
    -webkit-tap-highlight-color: transparent;
}

.mobile-notification-action:active {
    opacity: 0.6;
}

/* Notification List */
.mobile-notification-list {
    flex: 1;
    overflow-y: auto;
}

.mobile-notification-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    padding: var(--space-4) var(--space-5);
    text-decoration: none;
    color: var(--mobile-menu-text);
    border-bottom: 0.5px solid var(--mobile-menu-divider);
    -webkit-tap-highlight-color: transparent;
    transition: background var(--transition-fast) var(--ease-in-out);
}

.mobile-notification-item:active {
    background: var(--mobile-menu-item-hover);
}

.mobile-notification-item.unread {
    background: var(--color-indigo-alpha-4);
}

.mobile-notification-dot {
    width: calc(var(--space-2) + var(--space-1));
    height: calc(var(--space-2) + var(--space-1));
    border-radius: var(--radius-full);
    background: #ff3b30;
    flex-shrink: 0;
    margin-top: var(--space-2);
}

.mobile-notification-item:not(.unread) .mobile-notification-dot {
    background: var(--mobile-menu-divider);
}

.mobile-notification-content {
    flex: 1;
    min-width: 0;
}

.mobile-notification-message {
    font-size: var(--font-size-sm);
    line-height: 1.4;
    margin: 0 0 var(--space-1) 0;
}

.mobile-notification-time {
    font-size: var(--font-size-xs);
    color: var(--mobile-menu-text-secondary);
}

.mobile-notification-empty {
    padding: calc(var(--space-12) + var(--space-3)) var(--space-5);
    text-align: center;
}

.mobile-notification-empty i {
    font-size: calc(var(--font-size-3xl) + 1.125rem);
    color: var(--mobile-menu-divider);
    margin-bottom: var(--space-4);
}

.mobile-notification-empty p {
    color: var(--mobile-menu-text-secondary);
    font-size: var(--font-size-sm);
    margin: 0;
}


/* ============================================
   4. HIDE ON DESKTOP
   ============================================ */

@media (min-width: 1024px) {

    .mobile-tab-bar,
    .mobile-fullscreen-menu,
    .mobile-notification-sheet,
    .nexus-native-drawer,
    .nexus-native-drawer-overlay {
        display: none !important;
        visibility: hidden !important;
        pointer-events: none !important;
    }

    body {
        padding-bottom: 0 !important;
    }
}


/* ============================================
   5. LANDSCAPE MODE
   ============================================ */

@media (max-width: 1024px) and (orientation: landscape) {
    .mobile-tab-bar {
        height: 60px;
        --mobile-nav-height: 60px;
    }

    .mobile-tab-item {
        flex-direction: row;
        gap: var(--space-2);
    }

    .mobile-tab-item i {
        font-size: var(--font-size-xl);
    }

    .mobile-tab-item span {
        font-size: var(--font-size-xs);
    }

    .mobile-menu-header {
        padding-top: var(--space-3);
    }
}


/* ============================================
   6. REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {

    .mobile-fullscreen-menu,
    .mobile-notification-container,
    .mobile-tab-item {
        transition-duration: 0.01ms !important;
    }
}


/* ============================================
   7. DARK MODE ENHANCEMENTS
   ============================================ */

[data-theme="dark"] .mobile-tab-bar {
    background: var(--color-black-alpha-85);
}

[data-theme="dark"] .mobile-menu-header {
    background: linear-gradient(180deg, var(--color-indigo-alpha-8) 0%, transparent 100%);
}

[data-theme="dark"] .mobile-menu-stats {
    background: #1c1c1e;
}

[data-theme="dark"] .mobile-notification-container {
    background: #1c1c1e;
}

[data-theme="dark"] .mobile-tab-item.create-btn::before {
    box-shadow: 0 4px 16px var(--color-indigo-alpha-50);
}


/* ============================================
   8. ENHANCED MOBILE INTERACTIONS
   ============================================ */

/* Subtle pulse animation for Create button */
@keyframes create-btn-glow {

    0%,
    100% {
        box-shadow:
            0 4px 14px var(--color-indigo-alpha-40),
            0 2px 6px var(--color-indigo-alpha-20);
    }

    50% {
        box-shadow:
            0 6px 20px var(--color-indigo-alpha-50),
            0 3px 10px var(--color-indigo-alpha-30);
    }
}

.mobile-tab-item.create-btn::before {
    animation: create-btn-glow 3s ease-in-out infinite;
}

.mobile-tab-item.create-btn:active::before {
    animation: none;
}

/* Active indicator dot */
.mobile-tab-item:not(.create-btn).active::after {
    content: '';
    position: absolute;
    bottom: var(--space-1);
    left: 50%;
    transform: translateX(-50%);
    width: var(--space-1);
    height: var(--space-1);
    background: var(--color-primary-500);
    border-radius: var(--radius-full);
}

[data-theme="dark"] .mobile-tab-item:not(.create-btn).active::after,
.dark-mode .mobile-tab-item:not(.create-btn).active::after {
    background: var(--color-primary-400);
}


/* Smooth scrolling for menu */
.mobile-menu-body {
    scroll-behavior: smooth;
}

/* Better notification item hover/active state */
.mobile-notification-item {
    position: relative;
    overflow: hidden;
}

.mobile-notification-item::after {
    position: absolute;
    right: var(--space-5);
    top: 50%;
    transform: translateY(-50%);
    opacity: 0;
    transition: opacity var(--transition-fast) var(--ease-in-out);
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    content: '\f054';
    /* chevron-right */
    font-size: var(--font-size-xs);
    color: var(--mobile-menu-text-secondary);
}

.mobile-notification-item:active::after {
    opacity: 0.5;
}

/* Improved badge animation */
@keyframes badge-bounce {

    0%,
    100% {
        transform: translateX(4px) scale(1);
    }

    50% {
        transform: translateX(4px) scale(1.1);
    }
}

.mobile-tab-badge {
    animation: badge-bounce 2s ease-in-out infinite;
}

/* Menu item active highlight */
.mobile-menu-item {
    position: relative;
    overflow: hidden;
}

.mobile-menu-item::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background: var(--mobile-nav-active);
    transform: scaleY(0);
    transition: transform var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-item:active::before {
    transform: scaleY(1);
}

/* Stats card hover effect */
.mobile-menu-stat {
    transition: transform var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-stat:active {
    transform: scale(0.95);
}

/* Footer button improved states */
.mobile-menu-footer-btn {
    position: relative;
    overflow: hidden;
}

.mobile-menu-footer-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0;
    transition: opacity var(--transition-fast) var(--ease-in-out);
}

.mobile-menu-footer-btn:active::after {
    opacity: 0.1;
}

/* Theme toggle smooth transition */
.theme-toggle-inline {
    transition: background var(--transition-base) var(--ease-in-out), color var(--transition-base) var(--ease-in-out);
}

.theme-toggle-inline i {
    transition: transform var(--transition-base) var(--ease-in-out);
}

.theme-toggle-inline:active i {
    transform: rotate(180deg);
}

/* Sheet drag indicator animation */
@keyframes handle-hint {

    0%,
    100% {
        transform: scaleX(1);
    }

    50% {
        transform: scaleX(0.8);
    }
}

.mobile-notification-handle::after {
    animation: handle-hint 2s ease-in-out 1;
    animation-delay: 0.5s;
}

/* Empty state animation */
@keyframes empty-float {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-8px);
    }
}

.mobile-notification-empty i {
    animation: empty-float 3s ease-in-out infinite;
}


/* ============================================
   9. iOS SAFE AREA IMPROVEMENTS
   ============================================ */

/* Better notch handling */
@supports (padding-top: env(safe-area-inset-top)) {
    .mobile-fullscreen-menu {
        padding-top: env(safe-area-inset-top);
    }

    .mobile-menu-header {
        padding-top: calc(var(--space-4) + env(safe-area-inset-top));
    }
}

/* iPhone with Dynamic Island */
@supports (padding-top: max(env(safe-area-inset-top), 47px)) {
    .mobile-fullscreen-menu {
        padding-top: max(env(safe-area-inset-top), 0px);
    }
}

/* Home indicator area */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
    .mobile-notification-container {
        padding-bottom: max(var(--space-4), env(safe-area-inset-bottom));
    }
}

