!function(){"use strict";const e={threshold:80,maxPull:140,resistance:2.5,refreshTimeout:1e4,hapticOnThreshold:!0,hapticOnRefresh:!0,elasticContent:!0,showText:!0,autoInit:!0};let t=!1,n=!1,s=!1,r=0,o=0,i=0,c=null,a=null;function d(){return c||(c=document.createElement("div"),c.className="ptr-indicator",c.setAttribute("role","status"),c.setAttribute("aria-live","polite"),c.innerHTML=`\n            <div class="ptr-spinner">\n                <div class="ptr-spinner-track"></div>\n                <div class="ptr-spinner-progress"></div>\n                <div class="ptr-spinner-icon">\n                    <i class="fa-solid fa-arrow-down"></i>\n                </div>\n            </div>\n            ${e.showText?'<span class="ptr-text">Pull to refresh</span>':""}\n        `,document.body.appendChild(c),c)}function l(){return window.scrollY<=0}function u(e){t&&!s&&l()&&1===e.touches.length&&(r=e.touches[0].clientY,o=r,c||d())}function m(a){if(!t||s)return;if(0===r)return;o=a.touches[0].clientY;const d=o-r;d<=0?n&&g():(n||l())&&(a.preventDefault(),n||(n=!0,document.documentElement.classList.add("ptr-active"),c.classList.add("ptr-visible","ptr-pulling")),i=Math.min(d/e.resistance,e.maxPull),function(){const t=Math.min(i/e.threshold,1),n=Math.min(.6*i,50);c.style.transform=`translateX(-50%) translateY(${n}px)`;const s=180*t;c.style.setProperty("--ptr-rotation",`${s}deg`);const r=c.querySelector(".ptr-spinner-progress");r&&(r.style.transform=`rotate(${360*t-90}deg)`);if(e.elasticContent){const e=.3*i;document.documentElement.style.setProperty("--ptr-pull-distance",`${e}px`)}}(),i>=e.threshold?c.classList.contains("ptr-ready")||(c.classList.add("ptr-ready"),h("Release to refresh"),L("medium")):(c.classList.remove("ptr-ready"),h("Pull to refresh")))}function p(){n&&(document.documentElement.classList.add("ptr-releasing"),i>=e.threshold&&!s?f():g(),n=!1,r=0,o=0)}function h(e){const t=c?.querySelector(".ptr-text");t&&(t.textContent=e)}async function f(){s=!0,c.classList.remove("ptr-pulling","ptr-ready"),c.classList.add("ptr-refreshing"),h("Refreshing..."),document.documentElement.style.setProperty("--ptr-pull-distance","0px"),L("success");const t=setTimeout(()=>{console.warn("[PTR] Refresh timeout - forcing reset"),v(!1)},e.refreshTimeout);try{if(!a)return void window.location.reload();await a(),clearTimeout(t),v(!0)}catch(e){console.error("[PTR] Refresh error:",e),clearTimeout(t),v(!1)}}function v(e=!0){e?(c.classList.add("ptr-success"),h("Updated!"),setTimeout(()=>{g()},800)):g()}function g(){n=!1,s=!1,i=0,document.documentElement.classList.remove("ptr-active","ptr-releasing"),document.documentElement.style.removeProperty("--ptr-pull-distance"),c&&(c.classList.remove("ptr-visible","ptr-pulling","ptr-ready","ptr-refreshing","ptr-success"),c.style.transform=""),h("Pull to refresh")}function L(e="light"){if(!navigator.vibrate)return;const t={light:10,medium:20,success:[20,50,20]}[e]||10;navigator.vibrate(t)}function y(n={}){Object.assign(e,n),n.onRefresh&&(a=n.onRefresh),function(){if(window.innerWidth>1024)return!1;if(document.body.classList.contains("no-ptr"))return!1;if(document.documentElement.classList.contains("no-ptr"))return!1;const e=window.location.pathname;return!/\/listings\/?$/.test(e)&&(!["chat-page","messages-fullscreen","modal-open"].some(e=>document.body.classList.contains(e))&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches,!0))}()?(d(),document.addEventListener("touchstart",u,{passive:!0}),document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",p,{passive:!0}),document.addEventListener("touchcancel",g,{passive:!0}),window.addEventListener("pageshow",e=>{e.persisted&&g()}),window.addEventListener("resize",()=>{window.innerWidth>1024?(t=!1,g()):t=!0}),t=!0,console.log("[PTR] Initialized")):console.log("[PTR] Disabled on this device/page")}window.PullToRefresh={init:y,destroy:function(){t=!1,g(),document.removeEventListener("touchstart",u),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",p),document.removeEventListener("touchcancel",g),c&&(c.remove(),c=null),console.log("[PTR] Destroyed")},refresh:f,reset:g,isRefreshing:()=>s,setCallback:e=>{a=e}},e.autoInit&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>y()):setTimeout(()=>y(),100))}();