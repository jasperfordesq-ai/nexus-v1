const OrgUI={modal:{overlay:null,resolvePromise:null,init(){this.overlay=document.getElementById("orgModalOverlay"),document.getElementById("orgModalCancel").addEventListener("click",()=>this.close(!1)),document.getElementById("orgModalConfirm").addEventListener("click",()=>this.close(!0)),this.overlay.addEventListener("click",e=>{e.target===this.overlay&&this.close(!1)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.overlay.classList.contains("active")&&this.close(!1)})},show(e={}){const{title:t="Confirm Action",message:s="Are you sure you want to proceed?",type:n="warning",confirmText:i="Confirm",cancelText:o="Cancel",confirmClass:a="confirm",showInput:l=!1,inputPlaceholder:r="",inputValue:c=""}=e;document.getElementById("orgModalTitle").textContent=t,document.getElementById("orgModalText").textContent=s,document.getElementById("orgModalConfirm").textContent=i,document.getElementById("orgModalCancel").textContent=o;document.getElementById("orgModalConfirm").className="org-modal-btn "+a;const d=document.getElementById("orgModalIcon");d.className="org-modal-icon "+n;const u={warning:"fa-exclamation-triangle",danger:"fa-trash",success:"fa-check",info:"fa-info-circle"};d.innerHTML=`<i class="fa-solid ${u[n]||u.warning}"></i>`;const m=document.getElementById("orgModalInput");return m.style.display=l?"block":"none",m.placeholder=r,m.value=c,this.overlay.classList.add("active"),l&&m.focus(),new Promise(e=>{this.resolvePromise=e})},close(e){this.overlay.classList.remove("active");const t=document.getElementById("orgModalInput").value;this.resolvePromise&&(this.resolvePromise({confirmed:e,inputValue:t}),this.resolvePromise=null)},async confirm(e,t="Confirm Action"){return(await this.show({title:t,message:e,type:"warning"})).confirmed},async confirmDanger(e,t="Warning"){return(await this.show({title:t,message:e,type:"danger",confirmText:"Delete",confirmClass:"danger"})).confirmed},async prompt(e,t="Enter Value",s="",n=""){const i=await this.show({title:t,message:e,type:"info",showInput:!0,inputPlaceholder:s,inputValue:n});return i.confirmed?i.inputValue:null}},toast:{container:null,init(){this.container=document.getElementById("orgToastContainer")},show(e={}){const{title:t="Notification",message:s="",type:n="info",duration:i=5e3}=e,o=document.createElement("div");return o.className=`org-toast ${n}`,o.innerHTML=`\n                <div class="org-toast-icon">\n                    <i class="fa-solid ${{success:"fa-check",error:"fa-times",warning:"fa-exclamation",info:"fa-info"}[n]}"></i>\n                </div>\n                <div class="org-toast-content">\n                    <p class="org-toast-title">${this.escapeHtml(t)}</p>\n                    ${s?`<p class="org-toast-message">${this.escapeHtml(s)}</p>`:""}\n                </div>\n                <button class="org-toast-close" aria-label="Close notification">\n                    <i class="fa-solid fa-times"></i>\n                </button>\n            `,o.querySelector(".org-toast-close").addEventListener("click",()=>this.dismiss(o)),this.container.appendChild(o),requestAnimationFrame(()=>{o.classList.add("show")}),i>0&&setTimeout(()=>this.dismiss(o),i),o},dismiss(e){e.classList.remove("show"),setTimeout(()=>e.remove(),400)},success(e,t=""){return this.show({title:e,message:t,type:"success"})},error(e,t=""){return this.show({title:e,message:t,type:"error",duration:8e3})},warning(e,t=""){return this.show({title:e,message:t,type:"warning"})},info(e,t=""){return this.show({title:e,message:t,type:"info"})},escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}},validation:{rules:{required:e=>""!==e.trim()?null:"This field is required",email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:"Please enter a valid email",min:(e,t)=>parseFloat(e)>=t?null:`Minimum value is ${t}`,max:(e,t)=>parseFloat(e)<=t?null:`Maximum value is ${t}`,minLength:(e,t)=>e.length>=t?null:`Minimum ${t} characters required`,positive:e=>parseFloat(e)>0?null:"Value must be positive"},validate(e,t=[]){const s=e.value,n=e.closest(".org-form-group");for(const e of t){let t=null;if("string"==typeof e?t=this.rules[e]?.(s):"object"==typeof e&&(t=this.rules[e.type]?.(s,e.value)),t)return this.setInvalid(n,t),!1}return this.setValid(n),!0},setValid(e){if(!e)return;e.classList.remove("invalid"),e.classList.add("valid");const t=e.querySelector(".org-validation-message");t&&(t.textContent="")},setInvalid(e,t){if(!e)return;e.classList.remove("valid"),e.classList.add("invalid");const s=e.querySelector(".org-validation-message");s&&(s.textContent=t)},reset(e){if(!e)return;e.classList.remove("valid","invalid");const t=e.querySelector(".org-validation-message");t&&(t.textContent="")}},loading:{setButton(e,t=!0){if(t){e.classList.add("org-btn-loading"),e.disabled=!0,e.dataset.originalText=e.innerHTML;const t=e.querySelector(".org-btn-text")||e;t.dataset.text=t.textContent}else e.classList.remove("org-btn-loading"),e.disabled=!1,e.dataset.originalText&&(e.innerHTML=e.dataset.originalText)},showSkeleton(e,t=3){e.innerHTML=Array(t).fill('\n                <div style="display: flex; gap: 12px; padding: 16px; align-items: center;">\n                    <div class="org-skeleton org-skeleton-avatar"></div>\n                    <div style="flex: 1;">\n                        <div class="org-skeleton org-skeleton-text" style="width: 70%;"></div>\n                        <div class="org-skeleton org-skeleton-text short"></div>\n                    </div>\n                </div>\n            ').join("")}},bulkSelect:{selectedIds:new Set,init(e,t={}){const s=document.querySelector(e);if(!s)return;const{onSelectionChange:n=()=>{},itemSelector:i=".org-request-item",checkboxSelector:o=".org-bulk-checkbox"}=t;this.selectedIds.clear();const a=s.querySelector(".org-select-all");a&&a.addEventListener("change",e=>{s.querySelectorAll(o).forEach(t=>{t.checked=e.target.checked;const s=t.dataset.id;e.target.checked?this.selectedIds.add(s):this.selectedIds.delete(s)}),this.updateUI(s),n([...this.selectedIds])}),s.querySelectorAll(o).forEach(e=>{e.addEventListener("change",e=>{const t=e.target.dataset.id;e.target.checked?this.selectedIds.add(t):this.selectedIds.delete(t),this.updateUI(s),n([...this.selectedIds])})})},updateUI(e){const t=e.querySelector(".org-select-all-bar"),s=e.querySelector(".org-select-count");this.selectedIds.size>0?(t?.classList.add("show"),s&&(s.textContent=`${this.selectedIds.size} selected`)):t?.classList.remove("show")},getSelected(){return[...this.selectedIds]},clear(){this.selectedIds.clear()}},liveUpdate:{intervalId:null,start(e={}){const{url:t,interval:s=3e4,onUpdate:n=()=>{},indicator:i=null}=e;i&&(i.style.display="inline-flex"),this.intervalId=setInterval(async()=>{try{const e=await fetch(t),s=await e.json();n(s)}catch(e){console.error("Live update failed:",e)}},s)},stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}},init(){this.modal.init(),this.toast.init()}};document.addEventListener("DOMContentLoaded",()=>OrgUI.init());