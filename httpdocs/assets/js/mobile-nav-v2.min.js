let menuTriggerElement=null,notificationsTriggerElement=null;window.openMobileMenu=function(){const e=document.getElementById("mobileMenu"),i=document.querySelector('[onclick*="openMobileMenu"]');e&&(menuTriggerElement=document.activeElement||i,e.classList.add("active"),document.body.classList.add("mobile-menu-open"),i&&i.setAttribute("aria-expanded","true"),requestAnimationFrame(()=>{const i=e.querySelector(".mobile-menu-close");i&&i.focus(),initFocusTrap(e)}))},window.closeMobileMenu=function(){const e=document.getElementById("mobileMenu"),i=document.querySelector('[onclick*="openMobileMenu"]');e&&(e.classList.remove("active"),document.body.classList.remove("mobile-menu-open"),i&&i.setAttribute("aria-expanded","false"),removeFocusTrap(),menuTriggerElement&&"function"==typeof menuTriggerElement.focus&&menuTriggerElement.focus(),menuTriggerElement=null)},window.openMobileNotifications=function(){const e=document.getElementById("mobileNotifications"),i=document.querySelector('[onclick*="openMobileNotifications"]');e&&(notificationsTriggerElement=document.activeElement||i,e.classList.add("active"),document.body.classList.add("mobile-notifications-open"),i&&i.setAttribute("aria-expanded","true"),requestAnimationFrame(()=>{const i=e.querySelector('.mobile-notifications-close, [onclick*="closeMobileNotifications"]');i&&i.focus(),initFocusTrap(e)}))},window.closeMobileNotifications=function(){const e=document.getElementById("mobileNotifications"),i=document.querySelector('[onclick*="openMobileNotifications"]');e&&(e.classList.remove("active"),document.body.classList.remove("mobile-notifications-open"),i&&i.setAttribute("aria-expanded","false"),removeFocusTrap(),notificationsTriggerElement&&"function"==typeof notificationsTriggerElement.focus&&notificationsTriggerElement.focus(),notificationsTriggerElement=null)},function(){function e(){const e=document.getElementById("mobileMenu")?.classList.contains("active"),i=document.getElementById("mobileNotifications")?.classList.contains("active");e||document.body.classList.remove("mobile-menu-open"),i||document.body.classList.remove("mobile-notifications-open")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),document.addEventListener("visibilitychange",function(){document.hidden||e()})}();const Haptics={isSupported:()=>"vibrate"in navigator,light:()=>{Haptics.isSupported()&&navigator.vibrate(10),window.Capacitor?.Plugins?.Haptics&&window.Capacitor.Plugins.Haptics.impact({style:"light"})},medium:()=>{Haptics.isSupported()&&navigator.vibrate(20),window.Capacitor?.Plugins?.Haptics&&window.Capacitor.Plugins.Haptics.impact({style:"medium"})},success:()=>{Haptics.isSupported()&&navigator.vibrate([10,50,10]),window.Capacitor?.Plugins?.Haptics&&window.Capacitor.Plugins.Haptics.notification({type:"success"})}};!function(){const e=window.openMobileMenu,i=window.closeMobileMenu,t=window.openMobileNotifications,n=window.closeMobileNotifications;window.openMobileMenu=function(){Haptics.light(),e&&e()},window.closeMobileMenu=function(){Haptics.light(),i&&i()},window.openMobileNotifications=function(){Haptics.light(),t&&t()},window.closeMobileNotifications=function(){Haptics.light(),n&&n()}}();let focusTrapElement=null,focusTrapHandler=null;function initFocusTrap(e){if(!e)return;focusTrapElement=e;focusTrapHandler=function(i){if("Tab"!==i.key)return;const t=e.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]), [onclick]');if(0===t.length)return;const n=t[0],o=t[t.length-1];i.shiftKey?document.activeElement===n&&(i.preventDefault(),o.focus()):document.activeElement===o&&(i.preventDefault(),n.focus())},document.addEventListener("keydown",focusTrapHandler)}function removeFocusTrap(){focusTrapHandler&&(document.removeEventListener("keydown",focusTrapHandler),focusTrapHandler=null),focusTrapElement=null}function initializeHapticFeedback(){document.querySelectorAll(".mobile-tab-item").forEach(e=>{e.addEventListener("click",()=>Haptics.light())}),document.querySelectorAll(".mobile-menu-item").forEach(e=>{e.addEventListener("click",()=>Haptics.light())})}window.markAllNotificationsRead=function(){Haptics.success(),void 0!==window.nexusNotifications&&window.nexusNotifications.markAllRead&&window.nexusNotifications.markAllRead(),document.querySelectorAll(".mobile-notification-item.unread").forEach(e=>{e.classList.remove("unread")}),document.querySelectorAll(".mobile-tab-badge").forEach(e=>{e.style.display="none"})},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeHapticFeedback):initializeHapticFeedback(),document.addEventListener("keydown",function(e){"Escape"===e.key&&(closeMobileMenu(),closeMobileNotifications())});