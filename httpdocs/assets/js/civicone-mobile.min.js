!function(){"use strict";window.CivicOneMobile={init:function(){this.initBottomNav(),this.initPWAInstallPrompt(),this.initOfflineDetection(),this.initSkeletonLoading(),this.initTouchEnhancements(),console.log("[CivicOne] Mobile enhancements initialized")},initBottomNav:function(){const e=document.querySelector(".civic-bottom-nav");if(!e)return;const t=window.location.pathname;e.querySelectorAll(".civic-bottom-nav-item").forEach(e=>{const i=e.getAttribute("href");if(!i)return;const n=new URL(i,window.location.origin).pathname;("/"===n||n.endsWith("/")?t===n||t===n.slice(0,-1):t.startsWith(n))&&!e.classList.contains("civic-bottom-nav-item--create")&&(e.classList.add("active"),e.setAttribute("aria-current","page"))}),document.body.classList.add("has-civic-bottom-nav")},deferredPrompt:null,initPWAInstallPrompt:function(){const e=this;window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e.deferredPrompt=t,localStorage.getItem("civic-pwa-dismissed")||setTimeout(()=>{e.showPWABanner()},5e3)}),window.addEventListener("appinstalled",()=>{e.hidePWABanner(),localStorage.setItem("civic-pwa-installed","true")})},showPWABanner:function(){if(window.matchMedia("(display-mode: standalone)").matches)return;if(window.innerWidth>768)return;let e=document.querySelector(".civic-pwa-banner");e||(e=document.createElement("div"),e.className="civic-pwa-banner",e.setAttribute("role","dialog"),e.setAttribute("aria-labelledby","pwa-banner-title"),e.innerHTML='\n                    <div class="civic-pwa-banner-content">\n                        <div class="civic-pwa-banner-icon">\n                            <svg viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>\n                            </svg>\n                        </div>\n                        <div class="civic-pwa-banner-text">\n                            <div class="civic-pwa-banner-title" id="pwa-banner-title">Install App</div>\n                            <div class="civic-pwa-banner-desc">Add to your home screen for a better experience</div>\n                        </div>\n                    </div>\n                    <div class="civic-pwa-banner-actions">\n                        <button class="civic-pwa-banner-dismiss" type="button">Not now</button>\n                        <button class="civic-pwa-banner-install" type="button">Install</button>\n                    </div>\n                ',document.body.appendChild(e),e.querySelector(".civic-pwa-banner-dismiss").addEventListener("click",()=>{this.hidePWABanner(),localStorage.setItem("civic-pwa-dismissed",Date.now())}),e.querySelector(".civic-pwa-banner-install").addEventListener("click",()=>{this.installPWA()})),requestAnimationFrame(()=>{e.classList.add("visible")})},hidePWABanner:function(){const e=document.querySelector(".civic-pwa-banner");e&&(e.classList.remove("visible"),setTimeout(()=>e.remove(),300))},installPWA:async function(){if(!this.deferredPrompt)return;this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;"accepted"===e&&this.hidePWABanner(),this.deferredPrompt=null},networkUnsubscribe:null,initOfflineDetection:function(){const e=window.NexusNative?.Environment?.isCapacitor?.();if(window.innerWidth>768&&!e)return;let t=document.querySelector(".civic-offline-bar");function i(){document.body.classList.add("is-offline"),t.classList.add("visible")}function n(){document.body.classList.remove("is-offline"),t.classList.remove("visible")}t||(t=document.createElement("div"),t.className="civic-offline-bar",t.setAttribute("role","alert"),t.setAttribute("aria-live","polite"),t.textContent="You are currently offline. Some features may be unavailable.",document.body.insertBefore(t,document.body.firstChild)),window.NexusNative?.Network?(console.log("[CivicOneMobile] Using Capacitor Network plugin for offline detection"),this.networkUnsubscribe=window.NexusNative.Network.addListener((e,t)=>{e.connected&&!t?n():!e.connected&&t&&i()}),window.NexusNative.Network.getStatus().then(e=>{e.connected||i()})):(window.addEventListener("online",n),window.addEventListener("offline",i),setTimeout(function(){navigator.onLine||i()},1e3))},initPullToRefresh:function(){},resetPullIndicator:function(e){},initSkeletonLoading:function(){document.querySelectorAll("[data-skeleton]").forEach(e=>{const t=e.dataset.skeleton||"card",i=parseInt(e.dataset.skeletonCount)||3;0===e.children.length&&this.showSkeletons(e,i,t)})},showSkeletons:function(e,t=3,i="card"){if(e){e.setAttribute("aria-busy","true"),e.setAttribute("aria-label","Loading content");for(let n=0;n<t;n++){const t=this.createSkeleton(i);e.appendChild(t)}}},createSkeleton:function(e){const t=document.createElement("div");switch(t.className="civic-card civic-skeleton-card",t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),e){case"listing":t.innerHTML='\n                        <div class="civic-skeleton-card-header">\n                            <div class="civic-skeleton civic-skeleton-avatar"></div>\n                            <div class="civic-skeleton-card-meta">\n                                <div class="civic-skeleton civic-skeleton-text" style="width: 60%;"></div>\n                                <div class="civic-skeleton civic-skeleton-text" style="width: 40%;"></div>\n                            </div>\n                        </div>\n                        <div class="civic-skeleton-card-body">\n                            <div class="civic-skeleton civic-skeleton-title"></div>\n                            <div class="civic-skeleton civic-skeleton-text"></div>\n                            <div class="civic-skeleton civic-skeleton-text" style="width: 80%;"></div>\n                        </div>\n                    ';break;case"member":t.className="civic-member-card civic-skeleton-member",t.innerHTML='\n                        <div class="civic-skeleton civic-skeleton-avatar" style="width: 80px; height: 80px; margin: 0 auto 12px;"></div>\n                        <div class="civic-skeleton civic-skeleton-title" style="width: 70%; margin: 0 auto;"></div>\n                        <div class="civic-skeleton civic-skeleton-text" style="width: 50%; margin: 8px auto 0;"></div>\n                    ';break;default:t.innerHTML='\n                        <div class="civic-skeleton civic-skeleton-title"></div>\n                        <div class="civic-skeleton civic-skeleton-text"></div>\n                        <div class="civic-skeleton civic-skeleton-text" style="width: 80%;"></div>\n                    '}return t},hideSkeletons:function(e){if(!e)return;e.removeAttribute("aria-busy"),e.removeAttribute("aria-label");e.querySelectorAll(".civic-skeleton-card, .civic-skeleton-member").forEach(e=>e.remove())},initTouchEnhancements:function(){if(!("ontouchstart"in window))return;document.querySelectorAll(".civic-btn, .civic-bottom-nav-item, .civic-card a").forEach(e=>{e.addEventListener("touchstart",function(){this.classList.add("touch-active")},{passive:!0}),e.addEventListener("touchend",function(){this.classList.remove("touch-active")},{passive:!0}),e.addEventListener("touchcancel",function(){this.classList.remove("touch-active")},{passive:!0})}),document.addEventListener("touchend",function(e){const t=e.target;t.matches('button, a, [role="button"]')&&(e.preventDefault(),t.click())},{passive:!1})},showToast:function(e,t="default",i=3e3){let n=document.querySelector(".civic-toast-container");n||(n=document.createElement("div"),n.className="civic-toast-container",n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic","true"),document.body.appendChild(n));const c=document.createElement("div");c.className=`civic-toast ${t}`,c.setAttribute("role","status");return c.innerHTML=`${{success:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>',error:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',warning:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>',info:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>',default:""}[t]||""}<span>${e}</span>`,n.appendChild(c),setTimeout(()=>{c.classList.add("exit"),setTimeout(()=>c.remove(),200)},i),c}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>CivicOneMobile.init()):CivicOneMobile.init()}();