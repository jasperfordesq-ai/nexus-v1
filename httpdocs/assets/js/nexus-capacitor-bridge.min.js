!function(){"use strict";const t={isCapacitor:()=>"undefined"!=typeof Capacitor&&Capacitor.isNativePlatform(),isIOS:()=>/iPad|iPhone|iPod/.test(navigator.userAgent),isAndroid:()=>/Android/.test(navigator.userAgent),isPWA:()=>window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone,isMobile:()=>window.matchMedia("(max-width: 768px)").matches,getPlatform(){return this.isCapacitor()?Capacitor.getPlatform():this.isIOS()?"ios-web":this.isAndroid()?"android-web":"web"}},i={async impact(i="medium"){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Haptics){const{Haptics:t,ImpactStyle:a}=window.Capacitor.Plugins,n={light:a?.Light||"LIGHT",medium:a?.Medium||"MEDIUM",heavy:a?.Heavy||"HEAVY"};try{return await t.impact({style:n[i]}),!0}catch(t){console.warn("Native haptics failed:",t)}}if("vibrate"in navigator)try{const t={light:10,medium:20,heavy:40};return navigator.vibrate(t[i]||20),!0}catch(t){return!1}return!1},async notification(i="success"){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Haptics){const{Haptics:t,NotificationType:a}=window.Capacitor.Plugins,n={success:a?.Success||"SUCCESS",warning:a?.Warning||"WARNING",error:a?.Error||"ERROR"};try{return await t.notification({type:n[i]}),!0}catch(t){console.warn("Native notification haptics failed:",t)}}if("vibrate"in navigator){const t={success:[10,50,20,50,30],warning:[30,50,30],error:[50,30,50,30,50]};return navigator.vibrate(t[i]||t.success),!0}return!1},async selection(){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Haptics)try{return await window.Capacitor.Plugins.Haptics.selectionStart(),await window.Capacitor.Plugins.Haptics.selectionChanged(),await window.Capacitor.Plugins.Haptics.selectionEnd(),!0}catch(t){}return"vibrate"in navigator&&(navigator.vibrate(5),!0)},async vibrate(i){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Haptics)try{if(Array.isArray(i))for(let t=0;t<i.length;t++)t%2==0&&await window.Capacitor.Plugins.Haptics.impact({style:i[t]>30?"HEAVY":"MEDIUM"}),await new Promise(a=>setTimeout(a,i[t]));else await window.Capacitor.Plugins.Haptics.vibrate({duration:i});return!0}catch(t){}return"vibrate"in navigator&&(navigator.vibrate(i),!0)}},a={async setStyle(i="dark"){if(!t.isCapacitor()||!window.Capacitor?.Plugins?.StatusBar)return!1;try{const{StatusBar:t,Style:a}=window.Capacitor.Plugins;return await t.setStyle({style:"light"===i?a.Light:a.Dark}),!0}catch(t){return!1}},async setBackgroundColor(i){if(!t.isCapacitor()||!window.Capacitor?.Plugins?.StatusBar){const t=document.querySelector('meta[name="theme-color"]');return t&&t.setAttribute("content",i),!0}try{return await window.Capacitor.Plugins.StatusBar.setBackgroundColor({color:i}),!0}catch(t){return!1}},async hide(){if(!t.isCapacitor()||!window.Capacitor?.Plugins?.StatusBar)return!1;try{return await window.Capacitor.Plugins.StatusBar.hide(),!0}catch(t){return!1}},async show(){if(!t.isCapacitor()||!window.Capacitor?.Plugins?.StatusBar)return!1;try{return await window.Capacitor.Plugins.StatusBar.show(),!0}catch(t){return!1}}},n={async hide(){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Keyboard)try{return await window.Capacitor.Plugins.Keyboard.hide(),!0}catch(t){}return!(!document.activeElement||!document.activeElement.blur)&&(document.activeElement.blur(),!0)},async show(){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Keyboard)try{return await window.Capacitor.Plugins.Keyboard.show(),!0}catch(t){return!1}return!1}},e={async share(i={}){const{title:a,text:n,url:e,files:s}=i;if(t.isCapacitor()&&window.Capacitor?.Plugins?.Share)try{return await window.Capacitor.Plugins.Share.share({title:a,text:n,url:e,dialogTitle:a}),{success:!0,method:"native"}}catch(t){"Share canceled"!==t.message&&console.warn("Native share failed:",t)}if(navigator.share)try{const t={title:a,text:n,url:e};return s&&navigator.canShare&&navigator.canShare({files:s})&&(t.files=s),await navigator.share(t),{success:!0,method:"web-share"}}catch(t){"AbortError"!==t.name&&console.warn("Web share failed:",t)}return{success:!1,method:"fallback",data:i}},canShare:()=>t.isCapacitor()||!!navigator.share},s={async hide(i={}){if(!t.isCapacitor()||!window.Capacitor?.Plugins?.SplashScreen)return!1;try{return await window.Capacitor.Plugins.SplashScreen.hide({fadeOutDuration:i.fadeOutDuration||300}),!0}catch(t){return!1}}},o={_status:{connected:navigator.onLine,connectionType:"unknown"},_listeners:[],async init(){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Network)try{const{Network:t}=window.Capacitor.Plugins,i=await t.getStatus();return this._status={connected:i.connected,connectionType:i.connectionType||"unknown"},t.addListener("networkStatusChange",t=>{const i=this._status.connected;this._status={connected:t.connected,connectionType:t.connectionType||"unknown"},console.log("[NEXUS Network] Status changed:",this._status),this._listeners.forEach(t=>{try{t(this._status,i)}catch(t){console.warn("[NEXUS Network] Listener error:",t)}}),window.dispatchEvent(new CustomEvent("nexus:networkChange",{detail:{...this._status,wasConnected:i}}))}),console.log("[NEXUS Network] Capacitor Network plugin initialized:",this._status),!0}catch(t){console.warn("[NEXUS Network] Failed to initialize Capacitor Network:",t)}this._status={connected:navigator.onLine,connectionType:navigator.onLine?"unknown":"none"};return window.addEventListener("online",()=>{const t=this._status.connected;this._status={connected:!0,connectionType:"unknown"},this._notifyListeners(t)}),window.addEventListener("offline",()=>{const t=this._status.connected;this._status={connected:!1,connectionType:"none"},this._notifyListeners(t)}),console.log("[NEXUS Network] Web fallback initialized:",this._status),!0},_notifyListeners(t){this._listeners.forEach(i=>{try{i(this._status,t)}catch(t){console.warn("[NEXUS Network] Listener error:",t)}}),window.dispatchEvent(new CustomEvent("nexus:networkChange",{detail:{...this._status,wasConnected:t}}))},async getStatus(){if(t.isCapacitor()&&window.Capacitor?.Plugins?.Network)try{const{Network:t}=window.Capacitor.Plugins,i=await t.getStatus();this._status={connected:i.connected,connectionType:i.connectionType||"unknown"}}catch(t){}return{...this._status}},isConnected(){return this._status.connected},getConnectionType(){return this._status.connectionType},addListener(t){return"function"!=typeof t?()=>{}:(this._listeners.push(t),()=>{const i=this._listeners.indexOf(t);i>-1&&this._listeners.splice(i,1)})},removeAllListeners(){this._listeners=[]}};function r(){if(console.log("[NEXUS] Platform:",t.getPlatform()),console.log("[NEXUS] Capacitor:",t.isCapacitor()),console.log("[NEXUS] PWA:",t.isPWA()),window.NexusNativeNav&&window.NexusNativeNav.Haptics&&(window.NexusNativeNav.Haptics={light:()=>i.impact("light"),medium:()=>i.impact("medium"),heavy:()=>i.impact("heavy"),selection:()=>i.selection(),success:()=>i.notification("success")}),window.Nexus10x&&window.Nexus10x.Haptics&&(window.Nexus10x.Haptics={light:()=>i.impact("light"),medium:()=>i.impact("medium"),heavy:()=>i.impact("heavy"),selection:()=>i.selection(),success:()=>i.notification("success"),error:()=>i.notification("error")}),o.init(),function(){if(!t.isCapacitor())return;const a=["button",".btn",".btn--glass",'[role="button"]',".nexus-bottom-nav-item",".nexus-native-nav-item",".civic-bottom-nav-item",".fab",".nexus-fab",".card-action",".nav-link",".dropdown-item",".list-group-item-action",'input[type="submit"]','input[type="button"]',".toggle-switch",".checkbox-label",".radio-label"].join(", ");document.addEventListener("touchstart",t=>{const n=t.target.closest(a);if(!n)return;if(n.hasAttribute("data-no-haptic"))return;let e="light";(n.classList.contains("btn-primary")||n.classList.contains("btn--primary")||n.classList.contains("fab")||n.classList.contains("nexus-fab"))&&(e="medium"),n.classList.contains("toggle-switch")||n.classList.contains("checkbox-label")||n.classList.contains("radio-label")?i.selection():i.impact(e)},{passive:!0}),document.addEventListener("submit",t=>{t.target.checkValidity()&&i.notification("success")},{passive:!0}),console.log("[NEXUS] Auto-haptics initialized for interactive elements")}(),t.isCapacitor()){document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>s.hide(),300)});const t=document.documentElement.getAttribute("data-theme");a.setStyle("dark"===t?"light":"dark"),a.setBackgroundColor("dark"===t?"#0f172a":"#ffffff")}document.body.classList.add(`platform-${t.getPlatform()}`),t.isPWA()&&document.body.classList.add("is-pwa"),t.isCapacitor()&&document.body.classList.add("is-native")}window.NexusNative={Environment:t,Haptics:i,StatusBar:a,Keyboard:n,Share:e,Splash:s,Network:o,init:r},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r()}();