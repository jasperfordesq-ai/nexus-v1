document.body.addEventListener("submit",function(e){if(e.target.matches("form.ajax-form")){e.preventDefault();const t=e.target,s=t.querySelector('button[type="submit"]'),n=s?s.innerHTML:"";s&&(s.disabled=!0,s.innerHTML="...");const a=new FormData(t);a.append("ajax","1"),fetch(t.action,{method:t.method||"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:a}).then(e=>{const t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")?e.json():e.text().then(e=>{throw new Error("Server response was not JSON: "+e.substring(0,500))})}).then(e=>{if("success"===e.status||e.success){if(s){const e=t.getAttribute("data-success-text")||"âœ“ Done";s.innerHTML=e,s.classList.add("btn-success")}"true"===t.getAttribute("data-reload")&&setTimeout(()=>window.location.reload(),1e3)}else alert(e.message||"Action failed."),s&&(s.disabled=!1,s.innerHTML=n)}).catch(e=>{console.error(e),alert("Error: "+(e.message||e)),s&&(s.disabled=!1,s.innerHTML=n)})}});