function toggleMode(){const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),document.cookie="nexus_mode="+e+";path=/;max-age=31536000";const t=document.getElementById("modeIconContainer"),o=document.getElementById("modeIcon"),n=document.getElementById("modeLabel");t&&(t.className="mode-icon-container "+("dark"===e?"dark-mode":"light-mode")),o&&(o.className="fa-solid "+("dark"===e?"fa-moon":"fa-sun")+" mode-icon"),n&&(n.textContent="dark"===e?"Dark Mode":"Light Mode"),document.querySelectorAll(".mode-switcher").forEach(t=>{t.title="dark"===e?"Switch to Light Mode":"Switch to Dark Mode"}),document.querySelectorAll(".mode-toggle-icon").forEach(t=>{t.className="fa-solid "+("dark"===e?"fa-moon":"fa-sun")+" mode-toggle-icon"}),document.querySelectorAll(".mode-drawer-icon").forEach(t=>{t.className="mode-drawer-icon "+("dark"===e?"dark-mode":"light-mode")}),document.querySelectorAll(".mode-toggle-text").forEach(t=>{t.textContent="dark"===e?"Switch to Light":"Switch to Dark"}),document.querySelectorAll(".theme-toggle-icon").forEach(t=>{t.className="fa-solid "+("dark"===e?"fa-sun":"fa-moon")+" theme-toggle-icon"}),document.querySelectorAll(".theme-toggle-text").forEach(t=>{t.textContent="dark"===e?"Light Mode":"Dark Mode"}),document.querySelectorAll(".theme-toggle-switch").forEach(t=>{t.classList.toggle("active","dark"===e)}),window.dispatchEvent(new CustomEvent("modechange",{detail:{mode:e}})),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:e}})),navigator.vibrate&&navigator.vibrate(10)}function toggleTheme(){toggleMode()}!function(){let e=0,t=!1;function o(){const o=window.scrollY||window.pageYOffset,n=document.querySelector(".nexus-utility-bar"),a=document.querySelector(".nexus-navbar");o>60?(n?.classList.add("scrolled"),a?.classList.add("scrolled")):(n?.classList.remove("scrolled"),a?.classList.remove("scrolled")),e=o,t=!1}window.addEventListener("scroll",function(){t||(window.requestAnimationFrame(o),t=!0)},{passive:!0}),o()}(),function(){try{const e=window.location.pathname;if(!e||"string"!=typeof e)return void console.warn("[NAV] Invalid pathname:",e);const t=e.split("/").filter(e=>e&&e.length>0),o=["listings","groups","community-groups","members","volunteering","events","polls","goals","resources","news"];let n="/";for(const e of t)if(e&&o.includes(e)){n=e;break}(0===t.length||e.endsWith("/home")||1===t.length&&!o.includes(t[0]))&&(n="/"),document.querySelectorAll(".nav-link[data-nav-match]").forEach(e=>{const t=e.getAttribute("data-nav-match");t&&(t===n||"/"===t&&"/"===n)?(e.classList.add("active"),console.log("[NAV] Active class added to:",t,e)):e.classList.remove("active")}),console.log("[NAV] Active segment:",n,"from path:",window.location.pathname)}catch(e){console.error("[NAV] Error in active link detection:",e)}}(),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".collapsible-search-container"),t=document.getElementById("searchToggleBtn"),o=document.getElementById("searchCloseBtn"),n=document.getElementById("searchInput");document.getElementById("collapsibleSearch");t&&e&&(t.addEventListener("click",function(o){o.preventDefault(),e.classList.add("search-expanded"),document.body.classList.add("search-expanded"),t.setAttribute("aria-expanded","true"),setTimeout(()=>{n&&n.focus()},150)}),o&&o.addEventListener("click",function(o){o.preventDefault(),e.classList.remove("search-expanded"),document.body.classList.remove("search-expanded"),t.setAttribute("aria-expanded","false"),n&&(n.value="")}),document.addEventListener("keydown",function(o){"Escape"===o.key&&e.classList.contains("search-expanded")&&(e.classList.remove("search-expanded"),document.body.classList.remove("search-expanded"),t.setAttribute("aria-expanded","false"),n&&(n.value=""),t.focus())}),document.addEventListener("click",function(o){e.classList.contains("search-expanded")&&!e.contains(o.target)&&(e.classList.remove("search-expanded"),document.body.classList.remove("search-expanded"),t.setAttribute("aria-expanded","false"))}))}),window.innerWidth<=1024&&document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".nexus-utility-bar");if(!e)return;const t=e.querySelectorAll(".htb-dropdown");t.forEach(e=>{const o=e.querySelector("button");o&&o.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation(),t.forEach(t=>{t!==e&&t.classList.remove("active")}),e.classList.toggle("active")})}),document.addEventListener("click",function(e){e.target.closest(".nexus-utility-bar")||t.forEach(e=>e.classList.remove("active"))}),e.querySelectorAll(".htb-dropdown-content a").forEach(e=>{e.addEventListener("click",function(){t.forEach(e=>e.classList.remove("active"))})})}),window.nexusNotifDrawer={drawer:null,overlay:null,isOpen:!1,init:function(){this.drawer=document.getElementById("notif-drawer"),this.overlay=document.getElementById("notif-drawer-overlay"),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isOpen&&this.close()})},open:function(){this.drawer||this.init(),this.drawer&&(this.drawer.classList.add("open"),this.overlay.classList.add("open"),document.body.style.overflow="hidden",this.isOpen=!0)},close:function(){this.drawer&&(this.drawer.classList.remove("open"),this.overlay.classList.remove("open"),document.body.style.overflow="",this.isOpen=!1)},toggle:function(){this.isOpen?this.close():this.open()}},document.addEventListener("DOMContentLoaded",function(){window.nexusNotifDrawer.init()});