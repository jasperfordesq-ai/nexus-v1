!function(t){t.fn.jGravity=function(e){e=t.extend({target:"body",ignoreClass:"ignoreMe",weight:25,depth:5,drag:!0},e);var i="box_29837428937";return this.each(function(){t(e.target).find("*").not("body, html, script, link, meta, title, style, ."+e.ignoreClass).each(function(){var e=t(this),i=e.offset(),a=e.width(),n=e.height();100>a&&(a=100),100>n&&(n=100),e.attr("data-jgravity-h",n).attr("data-jgravity-w",a).attr("data-jgravity-l",i.left).attr("data-jgravity-t",i.top)}).addClass(i).css({position:"absolute",overflow:"hidden"}).each(function(){var e=t(this),i=e.attr("data-jgravity-h"),a=e.attr("data-jgravity-w"),n=e.attr("data-jgravity-l"),o=e.attr("data-jgravity-t");e.css("top",o+"px").css("left",n+"px").attr("width",a).attr("height",i)}),t("body").addClass("jGravity-active"),function(){var a=b2Vec2=Box2D.Common.Math.b2Vec2,n=b2BodyDef=Box2D.Dynamics.b2BodyDef,o=b2Body=Box2D.Dynamics.b2Body,r=b2FixtureDef=Box2D.Dynamics.b2FixtureDef,d=b2World=Box2D.Dynamics.b2World,s=b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape;Box2D.Collision.Shapes.b2CircleShape;var y,c=b2DebugDraw=Box2D.Dynamics.b2DebugDraw,w=b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef,h=(d=new d(new a(0,e.weight),!0),30),u=0;if(t("."+i).each(function(e){var i=t(this),a=i.width()/2,d=i.height()/2;u=e,(e=new n).type=o.b2_dynamicBody,e.position.Set(i.attr("data-jgravity-l")/h+a/h,i.attr("data-jgravity-t")/h+d/h),e.userData={id:u,elem:i[0],width:i.width(),height:i.height()},e=d.CreateBody(e),(i=new s).SetAsBox(a/h,d/h),(a=new r).shape=i,a.density=10,a.friction=.5,a.restitution=.5,e.CreateFixture(a)}),(n=new n).type=o.b2_staticBody,n.position.Set(0,window.innerHeight/h),u=d.CreateBody(n),(r=new s).SetAsBox(window.innerWidth/h,10/h),n.CreateFixture2(r),(n=new n).type=o.b2_staticBody,n.position.Set(0,0),u=d.CreateBody(n),(r=new s).SetAsBox(window.innerWidth/h,10/h),n.CreateFixture2(r),(n=new n).type=o.b2_staticBody,n.position.Set(window.innerWidth/h,0),u=d.CreateBody(n),(r=new s).SetAsBox(10/h,window.innerHeight/h),n.CreateFixture2(r),(n=new n).type=o.b2_staticBody,n.position.Set(0,0),u=d.CreateBody(n),(r=new s).SetAsBox(10/h,window.innerHeight/h),n.CreateFixture2(r),e.drag)var l=function(t){var e=new a(t.clientX/h,t.clientY/h),i=new Box2D.Collision.b2AABB;i.lowerBound.Set(e.x-.001,e.y-.001),i.upperBound.Set(e.x+.001,e.y+.001);var n=new Box2D.Dynamics.b2QueryCallback;if(d.QueryAABB(function(t){return t.GetBody().GetType()==o.b2_staticBody||!t.TestPoint(e)||(n.m_fixture=t,!1)},i),n.m_fixture){var r=n.m_fixture.GetBody(),s=new w;s.bodyA=d.GetGroundBody(),s.bodyB=r,s.target=e,s.collideConnected=!0,s.maxForce=300*r.GetMass(),y=d.CreateJoint(s),r.SetAwake(!0)}},g=function(t){y&&(t=new a(t.clientX/h,t.clientY/h),y.SetTarget(t))},B=function(){y&&(d.DestroyJoint(y),y=null)};if(e.debug){var b=t("<canvas></canvas>").attr("width",t(window).width()).attr("height",t(window).height()).css({position:"absolute",left:0,top:0,"pointer-events":"none","z-index":9999}).appendTo("body"),f=new c;f.SetSprite(b[0].getContext("2d")),f.SetDrawScale(h),f.SetFillAlpha(.5),f.SetLineThickness(1),f.SetFlags(c.e_shapeBit|c.e_jointBit),d.SetDebugDraw(f)}!function t(){if(d.Step(1/60,10,10),d.ClearForces(),e.debug)d.DrawDebugData();else for(var i=d.GetBodyList();i;i=i.GetNext()){var a=i.GetUserData();if(a){var n=a.elem,o=i.GetPosition(),r=i.GetAngle();n.style.left=o.x*h-a.width/2+"px",n.style.top=o.y*h-a.height/2+"px",n.style.transform="rotate("+r+"rad)",n.style.webkitTransform="rotate("+r+"rad)"}}e.drag&&(document.addEventListener("mousedown",function(t){l(t)}),document.addEventListener("mouseup",function(){B()}),document.addEventListener("mousemove",function(t){g(t)})),requestAnimationFrame(t)}()}()})}}(jQuery);